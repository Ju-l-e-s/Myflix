Output: E701 Multiple statements on one line (colon)
  --> infra/ai/app/main.py:57:16
   |
55 | # --- UTILS ---
56 | def get_first_sentences(text, n=2):
57 |     if not text: return "Pas de r√©sum√© disponible."
   |                ^
58 |     sentences = re.split(r'(?<=[.!?])\s+', text)
59 |     return " ".join(sentences[:n])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/app/main.py:85:68
   |
83 |                 def score(item):
84 |                     s = 0
85 |                     if item['title'].lower() == clean_query.lower(): s += 100
   |                                                                    ^
86 |                     if target_year and item.get('year') == target_year: s += 50
87 |                     return s
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/app/main.py:86:71
   |
84 |                     s = 0
85 |                     if item['title'].lower() == clean_query.lower(): s += 100
86 |                     if target_year and item.get('year') == target_year: s += 50
   |                                                                       ^
87 |                     return s
   |

E722 Do not use bare `except`
   --> infra/ai/maintenance/cleanup_share.py:121:18
    |
119 |                      shutil.move(dest_path, file_path)
120 |                      logging.info(f"Rollback r√©ussi pour {file_path}")
121 |                  except:
    |                  ^^^^^^
122 |                      pass
    |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/config.py:22:26
   |
21 | def is_authorized(uid):
22 |     if uid == SUPER_ADMIN: return True
   |                          ^
23 |     try:
24 |         with open(USERS_FILE, 'r') as f:
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/config.py:26:5
   |
24 |         with open(USERS_FILE, 'r') as f:
25 |             return uid in json.load(f)["allowed"]
26 |     except: return False
   |     ^^^^^^
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/config.py:26:11
   |
24 |         with open(USERS_FILE, 'r') as f:
25 |             return uid in json.load(f)["allowed"]
26 |     except: return False
   |           ^
   |

F403 `from config import *` used; unable to detect undefined names
 --> infra/ai/maintenance/handlers_admin.py:5:1
  |
3 | import json
4 | from telebot import types
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 |
7 | def save_users(users):
  |

F405 `USERS_FILE` may be undefined, or defined from star imports
 --> infra/ai/maintenance/handlers_admin.py:8:15
  |
7 | def save_users(users):
8 |     with open(USERS_FILE, "w") as f:
  |               ^^^^^^^^^^
9 |         json.dump({"allowed": users}, f)
  |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:14:45
   |
12 |     @bot.message_handler(commands=['status'])
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
   |                                             ^
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
16 |         try:
   |

E731 Do not assign a `lambda` expression, use a `def`
  --> infra/ai/maintenance/handlers_admin.py:15:9
   |
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |         try:
17 |             nvme = shutil.disk_usage('/')
   |
help: Rewrite `fmt` as a `def`

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:30:45
   |
28 |     @bot.message_handler(commands=['admin'])
29 |     def admin_menu(m):
30 |         if not is_authorized(m.from_user.id): return
   |                                             ^
31 |         markup = types.InlineKeyboardMarkup(row_width=1)
32 |         markup.add(types.InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_admin.py:41:23
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:41:44
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_admin.py:43:34
   |
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |                                  ^
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:45:17
   |
43 |                 users.append(uid); save_users(users)
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |                 ^
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_admin.py:46:9
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |         ^^^^^^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:46:15
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |               ^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:50:48
   |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
49 |     def admin_callback_router(call):
50 |         if not is_authorized(call.from_user.id): return
   |                                                ^
51 |         d = call.data.split(":")
52 |         cmd = d[1]
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_admin.py:67:23
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                     ^^^^^^^^^^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:67:44
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                          ^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_admin.py:74:23
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:74:44
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_admin.py:77:25
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                         ^^^^^^^^^^^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:77:36
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                                    ^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_admin.py:83:23
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_admin.py:83:44
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

F403 `from config import *` used; unable to detect undefined names
  --> infra/ai/maintenance/handlers_media.py:9:1
   |
 7 | from datetime import timedelta
 8 | from telebot import types
 9 | from config import *
   | ^^^^^^^^^^^^^^^^^^^^
10 | import share_engine
   |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:19:38
   |
18 | def list_media_unified(bot, m, cat, title, is_edit=False):
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
   |                                      ^^^^^^^^^^^
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_media.py:21:39
   |
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:22:27
   |
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:23:16
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:23:39
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_media.py:24:13
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |             ^^^^^^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:24:19
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |                   ^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:26:19
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
27 |     except: return
28 |     if not items:
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:26:42
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
27 |     except: return
28 |     if not items:
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_media.py:27:5
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |     ^^^^^^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:27:11
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |           ^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:30:19
   |
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
31 |         else: bot.send_message(m.chat.id, msg)
32 |         return
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:31:13
   |
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
31 |         else: bot.send_message(m.chat.id, msg)
   |             ^
32 |         return
33 |     text = f"{title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:34:36
   |
32 |         return
33 |     text = f"{title} : {cat}\n\n"
34 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
35 |     markup = types.InlineKeyboardMarkup(row_width=5)
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:38:15
   |
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:39:9
   |
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
40 |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:42:11
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |           ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:42:50
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |                                                  ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_media.py:46:29
   |
44 |     try:
45 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=10)
46 |         r.raise_for_status(); data = r.json()
   |                             ^
47 |         data.sort(key=lambda x: x.get('added', ''), reverse=True)
48 |         total = len(data)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:51:21
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                     ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_media.py:51:57
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                                                         ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:60:20
   |
58 |         markup.add(*btns)
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
   |                    ^
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:61:23
   |
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
   |                       ^
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:62:19
   |
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |                   ^
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:64:18
   |
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |                  ^
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:65:13
   |
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
   |             ^
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:66:26
   |
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |                          ^
67 |
68 | def register_media_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:71:36
   |
69 |     @bot.message_handler(commands=['films'])
70 |     def films_cmd(m):
71 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "films", 0, True, is_authorized)
   |                                    ^
72 |
73 |     @bot.message_handler(commands=['series'])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:75:36
   |
73 |     @bot.message_handler(commands=['series'])
74 |     def series_cmd(m):
75 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "series", 0, True, is_authorized)
   |                                    ^
76 |
77 |     @bot.message_handler(commands=['queue'])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:79:40
   |
77 |     @bot.message_handler(commands=['queue'])
78 |     def queue_command(m):
79 |         if not is_authorized(m.chat.id): return
   |                                        ^
80 |         def clean_title(name):
81 |             name = os.path.splitext(name)[0]
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:88:28
   |
86 | ‚Ä¶         tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b'‚Ä¶
87 | ‚Ä¶         clean = f"{title} ({year})" if year else title
88 | ‚Ä¶         for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
   |                          ^
89 | ‚Ä¶         return re.sub(r'\s+', ' ', clean).strip()
90 | ‚Ä¶     try:
   |

F405 `QBIT_URL` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_media.py:91:33
   |
89 |             return re.sub(r'\s+', ' ', clean).strip()
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
   |                                 ^^^^^^^^
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
93 |             q_text = "üì• **Queue :**\n\n"
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_media.py:91:76
   |
89 |             return re.sub(r'\s+', ' ', clean).strip()
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
   |                                                                            ^
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
93 |             q_text = "üì• **Queue :**\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_media.py:92:28
   |
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                            ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_media.py:92:62
   |
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                                                              ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:101:9
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |         ^^^^^^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:101:15
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |               ^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:105:48
    |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
104 |     def media_callback_router(call):
105 |         if not is_authorized(call.from_user.id): return
    |                                                ^
106 |         d = call.data.split(":")
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:112:19
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                   ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:112:53
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                     ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:117:40
    |
115 |             try:
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
    |                                        ^
118 |             except: pass
119 |             markup = types.InlineKeyboardMarkup()
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:118:13
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |             ^^^^^^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:118:19
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |                   ^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:128:23
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                       ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:128:57
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                         ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:139:33
    |
137 |                                 msg = f"‚úÖ **Lien de partage g√©n√©r√© :**\n\nüîó `{data['video']}`"
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
    |                                 ^
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:140:29
    |
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
    |                             ^
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:141:17
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                 ^^^^^^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:141:23
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                       ^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:142:17
    |
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |                 ^
143 |
144 |         elif d[0] == "sel":
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:146:27
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                           ^^^^^^^^^^^^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:146:50
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                  ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/handlers_media.py:146:70
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                      ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:150:41
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                               ^^^^^^^^^^^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:150:52
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:153:13
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |             ^^^^^^
154 |         elif d[0] == "act":
155 |             try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:153:19
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |                   ^
154 |         elif d[0] == "act":
155 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:156:27
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                           ^^^^^^^^^^^^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:156:50
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                  ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/handlers_media.py:156:70
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                      ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:157:50
    |
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
    |                                                  ^^^^^^^^^^^
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:159:13
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |             ^^^^^^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:159:19
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                   ^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:162:27
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:162:50
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/handlers_media.py:162:70
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/handlers_media.py:163:49
    |
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                                 ^
164 |                 if subtitles:
165 |                     markup = types.InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:168:21
    |
166 | ‚Ä¶                 markup.add(types.InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), types.InlineKeyboardB‚Ä¶
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
    |                   ^
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
170 | ‚Ä¶     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:169:13
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |           ^^^^^^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:169:19
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                 ^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/ai/maintenance/handlers_media.py:172:27
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:172:50
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/handlers_media.py:172:70
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:176:44
    |
174 | ‚Ä¶         bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
175 | ‚Ä¶         data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶         if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", parse ‚Ä¶
    |                                      ^
177 | ‚Ä¶         else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶     except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:177:21
    |
175 | ‚Ä¶             data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
    |                   ^
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/handlers_media.py:178:13
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |           ^^^^^^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:178:19
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |                 ^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/handlers_media.py:179:30
    |
177 |                 else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 |             except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 |         elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                              ^
    |

F403 `from config import *` used; unable to detect undefined names
 --> infra/ai/maintenance/handlers_search.py:7:1
  |
5 | import os
6 | from telebot.types import InlineKeyboardMarkup, InlineKeyboardButton
7 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
8 |
9 | def stream_gpt_json(query):
  |

F405 `OPENAI_KEY` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:10:79
   |
 9 | def stream_gpt_json(query):
10 |     headers = {"Content-Type": "application/json", "Authorization": f"Bearer {OPENAI_KEY}"}
   |                                                                               ^^^^^^^^^^
11 |     prompt = f"Analyse : '{query}'. Renvoie JSON : {{\"titre\": \"str\", \"type\": \"serie|film\"}}"
12 |     try:
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_search.py:15:5
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |     ^^^^^^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:15:11
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |           ^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:20:45
   |
18 |     @bot.message_handler(commands=['get'])
19 |     def handle_get(m):
20 |         if not is_authorized(m.from_user.id): return
   |                                             ^
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:22:26
   |
20 |         if not is_authorized(m.from_user.id): return
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |                          ^
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:23:13
   |
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |             ^
24 |
25 |     @bot.message_handler(func=lambda m: True)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:27:40
   |
25 |     @bot.message_handler(func=lambda m: True)
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
   |                                        ^
28 |         if m.text.startswith('/'): return
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:28:34
   |
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
28 |         if m.text.startswith('/'): return
   |                                  ^
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:33:48
   |
31 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("dl_sel:"))
32 |     def download_callback_handler(call):
33 |         if not is_authorized(call.from_user.id): return
   |                                                ^
34 |         d = call.data.split(":")
35 |         cat, idx = d[1], int(d[2])
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:37:23
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                       ^^^^^^^^^^^^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:37:46
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                                              ^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:44:19
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                   ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:44:53
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                                     ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:58:31
   |
56 |             }
57 |             payload[id_key] = item[id_key]
58 |             if cat == "series": payload["languageProfileId"] = 1
   |                               ^
59 |
60 |             r = requests.post(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, json=payload, timeout=10)
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_search.py:74:30
   |
72 |     try:
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
   |                              ^
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_search.py:75:5
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |     ^^^^^^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:75:11
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |           ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_search.py:75:26
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |                          ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:76:11
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |           ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:76:45
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                             ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:80:23
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                       ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/handlers_search.py:80:73
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                                                                          ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:82:27
   |
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:83:16
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:83:39
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_search.py:84:13
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |             ^^^^^^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:84:19
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |                   ^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/ai/maintenance/handlers_search.py:86:19
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:86:42
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:89:52
   |
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
89 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
   |                                                    ^
90 |         markup = InlineKeyboardMarkup()
91 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i-1}") for i in range(1, limit+1)]
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/handlers_search.py:94:5
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |     ^^^^^^
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/handlers_search.py:94:11
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |           ^
   |

F403 `from config import *` used; unable to detect undefined names
 --> infra/ai/maintenance/main.py:5:1
  |
3 | import logging
4 | from flask import Flask
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 | from handlers_admin import register_admin_handlers
7 | from handlers_media import register_media_handlers
  |

F405 `TOKEN` may be undefined, or defined from star imports
  --> infra/ai/maintenance/main.py:11:23
   |
10 | # --- CONFIGURATION PRINCIPALE ---
11 | bot = telebot.TeleBot(TOKEN)
   |                       ^^^^^
12 |
13 | # --- FLASK SERVER ---
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/ai/maintenance/main.py:32:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/ai/maintenance/main.py:33:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/ai/maintenance/main.py:34:35
   |
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |                                   ^^^^^^^^^^^^^
35 |     
36 |     print("üöÄ Bot d√©marr√© en mode modulaire (Orchestrateur Clean)...")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:25:20
   |
23 |     tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b', r'\b‚Ä¶
24 |     clean = f"{title} ({year})" if year else title
25 |     for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
   |                    ^
26 |     return re.sub(r'\s+', ' ', clean).strip()
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:30:29
   |
28 | def get_size(p):
29 |     try:
30 |         if os.path.isfile(p): return os.path.getsize(p)
   |                             ^
31 |         return sum(os.path.getsize(os.path.join(r, d, f)) for r, d, fs in os.walk(p) for f in fs)
32 |     except: return 0
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/media_manager.py:32:5
   |
30 |         if os.path.isfile(p): return os.path.getsize(p)
31 |         return sum(os.path.getsize(os.path.join(r, d, f)) for r, d, fs in os.walk(p) for f in fs)
32 |     except: return 0
   |     ^^^^^^
33 |
34 | def find_local_media(query):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:32:11
   |
30 |         if os.path.isfile(p): return os.path.getsize(p)
31 |         return sum(os.path.getsize(os.path.join(r, d, f)) for r, d, fs in os.walk(p) for f in fs)
32 |     except: return 0
   |           ^
33 |
34 | def find_local_media(query):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:40:37
   |
38 |     for cat in PATHS:
39 |         for d, is_nvme in [(p, True) for p in PATHS[cat]["nvme"]] + [(PATHS[cat]["hdd"], False)]:
40 |             if not os.path.exists(d): continue
   |                                     ^
41 |             for item in os.listdir(d):
42 |                 if q in item.lower().replace(" ", "").replace(".", ""):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:57:16
   |
55 |     media = []
56 |     conf = PATHS.get(category)
57 |     if not conf: return []
   |                ^
58 |     for d, is_nvme in [(p, True) for p in conf["nvme"]] + [(conf["hdd"], False)]:
59 |         if not os.path.exists(d): continue
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:59:33
   |
57 |     if not conf: return []
58 |     for d, is_nvme in [(p, True) for p in conf["nvme"]] + [(conf["hdd"], False)]:
59 |         if not os.path.exists(d): continue
   |                                 ^
60 |         for f in os.listdir(d):
61 |             if f.startswith('.'): continue
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:61:33
   |
59 |         if not os.path.exists(d): continue
60 |         for f in os.listdir(d):
61 |             if f.startswith('.'): continue
   |                                 ^
62 |             path = os.path.join(d, f); size = get_size(path)
63 |             if size < MIN_SIZE_BYTES: continue
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/media_manager.py:62:38
   |
60 | ‚Ä¶     for f in os.listdir(d):
61 | ‚Ä¶         if f.startswith('.'): continue
62 | ‚Ä¶         path = os.path.join(d, f); size = get_size(path)
   |                                    ^
63 | ‚Ä¶         if size < MIN_SIZE_BYTES: continue
64 | ‚Ä¶         media.append({"name": clean_media_name(f), "real_name": f, "size_gb": round(size / (1024**3), 2), "is_nvme": is_nvme, "path"‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:63:37
   |
61 |             if f.startswith('.'): continue
62 |             path = os.path.join(d, f); size = get_size(path)
63 |             if size < MIN_SIZE_BYTES: continue
   |                                     ^
64 |             media.append({"name": clean_media_name(f), "real_name": f, "size_gb": round(size / (1024**3), 2), "is_nvme": is_nvme, "pat‚Ä¶
65 |     return sorted(media, key=lambda x: x['size_gb'], reverse=True)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:68:25
   |
67 | if __name__ == "__main__":
68 |     if len(sys.argv) < 2: sys.exit(1)
   |                         ^
69 |     cmd = sys.argv[1]
70 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:70:26
   |
68 |     if len(sys.argv) < 2: sys.exit(1)
69 |     cmd = sys.argv[1]
70 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
   |                          ^
71 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
72 |     elif cmd == "status":
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:71:31
   |
69 |     cmd = sys.argv[1]
70 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
71 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
   |                               ^
72 |     elif cmd == "status":
73 |         u = shutil.disk_usage("/"); h = shutil.disk_usage("/mnt/externe") if os.path.exists("/mnt/externe") else u
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/media_manager.py:73:35
   |
71 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
72 |     elif cmd == "status":
73 |         u = shutil.disk_usage("/"); h = shutil.disk_usage("/mnt/externe") if os.path.exists("/mnt/externe") else u
   |                                   ^
74 |         print(json.dumps({"nvme_free": u.free//1024**3, "hdd_free": h.free//1024**3}))
75 |     elif cmd == "action":
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:78:35
   |
76 |         act, cat, path = sys.argv[2], sys.argv[3], sys.argv[4]
77 |         if act == "del":
78 |             if os.path.isdir(path): shutil.rmtree(path)
   |                                   ^
79 |             else: os.remove(path)
80 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:79:17
   |
77 |         if act == "del":
78 |             if os.path.isdir(path): shutil.rmtree(path)
79 |             else: os.remove(path)
   |                 ^
80 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
81 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:80:26
   |
78 |             if os.path.isdir(path): shutil.rmtree(path)
79 |             else: os.remove(path)
80 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
   |                          ^
81 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
82 |         print("Done")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/media_manager.py:81:26
   |
79 |             else: os.remove(path)
80 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
81 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
   |                          ^
82 |         print("Done")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:32:8
   |
30 | # --- UTILS & STORAGE ---
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
33 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/pi_bot.py:33:5
   |
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
33 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
34 |
35 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:33:11
   |
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
33 |     except: return [SUPER_ADMIN]
   |           ^
34 |
35 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:42:94
   |
41 | def get_storage_emoji(item):
42 |     if not item.get('hasFile') and item.get('statistics', {}).get('episodeFileCount', 0) == 0: return "üî¥"
   |                                                                                              ^
43 |     path = item.get('path', '')
44 |     return "üìö" if path and "/mnt/externe" in path else "üöÄ"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:49:37
   |
47 | @bot.message_handler(commands=['admin'])
48 | def admin_main(m):
49 |     if m.from_user.id != SUPER_ADMIN: return
   |                                     ^
50 |     markup = InlineKeyboardMarkup(row_width=1)
51 |     markup.add(InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/pi_bot.py:62:30
   |
60 |         users = load_allowed_users()
61 |         if uid not in users:
62 |             users.append(uid); save_users(users)
   |                              ^
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:64:13
   |
62 |             users.append(uid); save_users(users)
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |             ^
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/pi_bot.py:65:5
   |
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |     ^^^^^^
66 |
67 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:65:11
   |
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |           ^
66 |
67 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/pi_bot.py:71:39
   |
69 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
70 |     try:
71 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:73:16
   |
71 |         items = json.loads(res.stdout); ctx = {}
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
74 |             except: ctx = {}
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/pi_bot.py:74:13
   |
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
74 |             except: ctx = {}
   |             ^^^^^^
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:74:19
   |
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
74 |             except: ctx = {}
   |                   ^
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:76:42
   |
74 |             except: ctx = {}
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
77 |     except: return
78 |     if not items:
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/pi_bot.py:77:5
   |
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
77 |     except: return
   |     ^^^^^^
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:77:11
   |
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
77 |     except: return
   |           ^
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:80:19
   |
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
80 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
81 |         else: bot.send_message(m.chat.id, msg)
82 |         return
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:81:13
   |
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
80 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
81 |         else: bot.send_message(m.chat.id, msg)
   |             ^
82 |         return
83 |     text = f"üé¨ {title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:84:36
   |
82 |         return
83 |     text = f"üé¨ {title} : {cat}\n\n"
84 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
85 |     markup = InlineKeyboardMarkup(row_width=5)
86 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:88:15
   |
86 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
87 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
88 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
89 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot.py:89:9
   |
87 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
88 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
89 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
90 |
91 | # --- PAGED MEDIA UI (LIVE API) ---
   |

E702 Multiple statements on one line (semicolon)
  --> infra/ai/maintenance/pi_bot.py:97:29
   |
95 |     try:
96 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
97 |         r.raise_for_status(); data = r.json()
   |                             ^
98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
   |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:98:31
    |
 96 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
 97 |         r.raise_for_status(); data = r.json()
 98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
    |                               ^
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:99:13
    |
 97 |         r.raise_for_status(); data = r.json()
 98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
    |             ^
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:101:27
    |
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |                           ^
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:103:21
    |
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                     ^
104 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
105 |         for i, item in enumerate(items, 1):
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:103:59
    |
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                                                            ^
104 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
105 |         for i, item in enumerate(items, 1):
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:111:20
    |
109 |         markup.add(*btns)
110 |         nav = []
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
    |                    ^
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
113 |         if nav: markup.row(*nav)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:112:23
    |
110 |         nav = []
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
    |                       ^
113 |         if nav: markup.row(*nav)
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:113:15
    |
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
113 |         if nav: markup.row(*nav)
    |               ^
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:115:18
    |
113 |         if nav: markup.row(*nav)
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |                  ^
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:116:13
    |
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
    |             ^
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:117:5
    |
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |     ^^^^^^
118 |
119 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:117:11
    |
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |           ^
118 |
119 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:121:32
    |
119 | @bot.message_handler(commands=['films'])
120 | def films_cmd(m):
121 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "films", 0, True)
    |                                ^
122 |
123 | @bot.message_handler(commands=['series'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:125:32
    |
123 | @bot.message_handler(commands=['series'])
124 | def series_cmd(m):
125 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "series", 0, True)
    |                                ^
126 |
127 | # --- SEARCH ENGINE (/GET) ---
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:134:5
    |
132 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
133 |         return res.json()['choices'][0]['message']['content']
134 |     except: return None
    |     ^^^^^^
135 |
136 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:134:11
    |
132 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
133 |         return res.json()['choices'][0]['message']['content']
134 |     except: return None
    |           ^
135 |
136 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:138:36
    |
136 | @bot.message_handler(commands=['get'])
137 | def handle_get(m):
138 |     if not is_authorized(m.chat.id): return
    |                                    ^
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:140:22
    |
138 |     if not is_authorized(m.chat.id): return
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
    |                      ^
141 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:141:9
    |
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
141 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |         ^
142 |
143 | def process_get_request(m, query):
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:148:30
    |
146 |     try:
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
    |                              ^
149 |     except: titre = query; cat = "movie"
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:149:5
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |     ^^^^^^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:149:11
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |           ^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:149:26
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |                          ^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:154:23
    |
152 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
153 |         results = r.json()
154 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                       ^
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:154:73
    |
152 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
153 |         results = r.json()
154 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                                                                          ^
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:157:52
    |
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
157 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
    |                                                    ^
158 |         markup = InlineKeyboardMarkup()
159 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i}") for i in range(1, limit+1)]
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:162:5
    |
160 |         markup.add(*btns)
161 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
162 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |     ^^^^^^
163 |
164 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:162:11
    |
160 |         markup.add(*btns)
161 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
162 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |           ^
163 |
164 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:167:44
    |
165 | @bot.callback_query_handler(func=lambda call: True)
166 | def master_router(call):
167 |     if not is_authorized(call.from_user.id): return
    |                                            ^
168 |     d = call.data.split(":")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:172:27
    |
170 |     # 1. New Paged UI Callbacks
171 |     if d[0] in ["m_pag", "m_sel", "m_act", "dl_sel"]:
172 |         if d[0] == "m_pag": show_media_list(call.message.chat.id, call.message.message_id, d[1], int(d[2]))
    |                           ^
173 |         elif d[0] == "m_sel":
174 |             markup = InlineKeyboardMarkup()
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:179:30
    |
177 | ‚Ä¶                    InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data=f"m_pag:{d[1]}:0"))
178 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
179 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
    |                            ^
180 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
181 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:180:29
    |
178 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
179 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
180 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
    |                           ^
181 | ‚Ä¶     return
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:199:41
    |
197 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
198 | ‚Ä¶     elif cmd == "users_list":
199 | ‚Ä¶         users = load_allowed_users(); text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
    |                                       ^
200 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=InlineKeyboardMarkup().add(InlineKe‚Ä¶
201 | ‚Ä¶     elif cmd == "users_add":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:205:41
    |
203 |             bot.register_next_step_handler(msg, process_user_add)
204 |         elif cmd == "users_rev":
205 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
    |                                         ^
206 |             for u in users:
207 |                 if u == SUPER_ADMIN: continue
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:207:36
    |
205 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
206 |             for u in users:
207 |                 if u == SUPER_ADMIN: continue
    |                                    ^
208 |                 markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
209 |             markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:212:28
    |
210 | ‚Ä¶         bot.edit_message_text("S√©lectionnez l'ID √† r√©voquer :", call.message.chat.id, call.message.message_id, reply_markup=markup)
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
    |                          ^
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:213:28
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                          ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:213:47
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                             ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:213:66
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                                                ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:219:33
    |
217 | ‚Ä¶         markup.add(InlineKeyboardButton("üé¨ Films", callback_data="adm:list_owned:movies"), InlineKeyboardButton("üì∫ S√©ries", callba ‚Ä¶
218 | ‚Ä¶         bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
219 | ‚Ä¶     elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
    |                               ^
220 | ‚Ä¶     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
221 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:220:28
    |
218 |             bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
219 |         elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
220 |         elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                            ^
221 |         return
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:226:46
    |
224 |     if d[0] == "sel":
225 |         try:
226 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                              ^
227 |             markup = InlineKeyboardMarkup(row_width=2)
228 |             act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:226:66
    |
224 |     if d[0] == "sel":
225 |         try:
226 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                  ^
227 |             markup = InlineKeyboardMarkup(row_width=2)
228 |             act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:230:48
    |
228 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
229 | ‚Ä¶     markup.add(InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), InlineKeyboardButton("üóëÔ∏è Supprimer"‚Ä¶
230 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
231 | ‚Ä¶     markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:233:9
    |
231 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
233 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |         ^^^^^^
234 |     elif d[0] == "act":
235 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:233:15
    |
231 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
233 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |               ^
234 |     elif d[0] == "act":
235 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:236:46
    |
234 |     elif d[0] == "act":
235 |         try:
236 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                              ^
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:236:66
    |
234 |     elif d[0] == "act":
235 |         try:
236 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                  ^
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:239:9
    |
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
239 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
240 |     elif d[0] == "share_exec":
241 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:239:15
    |
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
239 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
240 |     elif d[0] == "share_exec":
241 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:242:46
    |
240 |     elif d[0] == "share_exec":
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
244 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:242:66
    |
240 |     elif d[0] == "share_exec":
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
244 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:243:45
    |
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                             ^
244 |             if subtitles:
245 |                 markup = InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:248:17
    |
246 |                 markup.add(InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), InlineKeyboardButton("üé¨ Remu ‚Ä¶
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
    |                 ^
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
250 |     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:249:9
    |
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
250 |     elif d[0] == "share_final":
251 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:249:15
    |
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
250 |     elif d[0] == "share_final":
251 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:252:46
    |
250 |     elif d[0] == "share_final":
251 |         try:
252 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
253 |             remux_opt = True if d[2] == "remux" else False
254 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:252:66
    |
250 |     elif d[0] == "share_final":
251 |         try:
252 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
253 |             remux_opt = True if d[2] == "remux" else False
254 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:259:17
    |
257 |                 msg = f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`"
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
    |                 ^
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:260:9
    |
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |         ^^^^^^
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:260:15
    |
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |               ^
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:261:26
    |
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
262 |
263 | # --- STATUS & QUEUE ---
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:266:36
    |
264 | @bot.message_handler(commands=['status'])
265 | def status_command(m):
266 |     if not is_authorized(m.chat.id): return
    |                                    ^
267 |     try:
268 |         nvme = shutil.disk_usage('/')
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:275:5
    |
273 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
274 |         bot.reply_to(m, msg, parse_mode='Markdown')
275 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |     ^^^^^^
276 |
277 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:275:11
    |
273 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
274 |         bot.reply_to(m, msg, parse_mode='Markdown')
275 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |           ^
276 |
277 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:279:36
    |
277 | @bot.message_handler(commands=['queue'])
278 | def queue_command(m):
279 |     if not is_authorized(m.chat.id): return
    |                                    ^
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:281:82
    |
279 |     if not is_authorized(m.chat.id): return
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |                                                                                  ^
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
283 |         q_text = "üì• **Queue :**\n\n"
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:282:24
    |
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                        ^
283 |         q_text = "üì• **Queue :**\n\n"
284 |         for t in torrents:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/ai/maintenance/pi_bot.py:282:58
    |
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                                                          ^
283 |         q_text = "üì• **Queue :**\n\n"
284 |         for t in torrents:
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot.py:289:5
    |
287 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
288 |         bot.reply_to(m, q_text, parse_mode='Markdown')
289 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |     ^^^^^^
290 |
291 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot.py:289:11
    |
287 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
288 |         bot.reply_to(m, q_text, parse_mode='Markdown')
289 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |           ^
290 |
291 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot_debug.py:34:8
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
35 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/pi_bot_debug.py:35:5
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
35 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
36 |
37 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot_debug.py:35:11
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
35 |     except: return [SUPER_ADMIN]
   |           ^
36 |
37 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot_debug.py:58:40
   |
56 | @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
57 | def admin_router(call):
58 |     if call.from_user.id != SUPER_ADMIN: return
   |                                        ^
59 |     parts = call.data.split(":")
60 |     cmd = parts[1]
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/pi_bot_debug.py:94:32
   |
92 |         markup = InlineKeyboardMarkup(row_width=1)
93 |         for u in users:
94 |             if u == SUPER_ADMIN: continue
   |                                ^
95 |             markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
96 |         markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:122:24
    |
120 |         bot.edit_message_text("üßπ **Nettoyage SSD**\n\nFonctionnalit√© en cours de d√©veloppement.", call.message.chat.id, call.message.‚Ä¶
121 |     
122 |     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                        ^
123 |
124 | def process_user_add(m):
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot_debug.py:134:5
    |
132 |         else:
133 |             bot.reply_to(m, "‚ÑπÔ∏è Cet utilisateur est d√©j√† autoris√©.")
134 |     except:
    |     ^^^^^^
135 |         bot.reply_to(m, "‚ùå ID invalide. Veuillez envoyer un nombre.")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:144:16
    |
142 |         ctx = {}
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
    |                ^
145 |             except: ctx = {}
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot_debug.py:145:13
    |
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
145 |             except: ctx = {}
    |             ^^^^^^
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:145:19
    |
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
145 |             except: ctx = {}
    |                   ^
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:147:42
    |
145 |             except: ctx = {}
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                          ^
148 |     except Exception as e:
149 |         logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:153:19
    |
151 |     if not items:
152 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
153 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
    |                   ^
154 |         else: bot.send_message(m.chat.id, msg)
155 |         return
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:154:13
    |
152 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
153 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
154 |         else: bot.send_message(m.chat.id, msg)
    |             ^
155 |         return
156 |     text = f"üé¨ {title} : {cat}\n\n"
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:157:36
    |
155 |         return
156 |     text = f"üé¨ {title} : {cat}\n\n"
157 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
    |                                    ^
158 |     markup = InlineKeyboardMarkup(row_width=5)
159 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:161:15
    |
159 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
160 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
161 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
    |               ^
162 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:162:9
    |
160 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
161 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
162 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |         ^
163 |
164 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:166:44
    |
164 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
165 | def media_callbacks(call):
166 |     if not is_authorized(call.from_user.id): return
    |                                            ^
167 |     d = call.data.split(":")
168 |     if d[0] == "sel":
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:170:46
    |
168 |     if d[0] == "sel":
169 |         try:
170 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
171 |             item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
172 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:186:46
    |
184 |     elif d[0] == "act":
185 |         try:
186 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
187 |             item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
188 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:196:46
    |
194 |     elif d[0] == "share_exec":
195 |         try:
196 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
197 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
198 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:219:46
    |
217 |     elif d[0] == "share_final":
218 |         try:
219 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
220 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
221 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:243:26
    |
241 |         else:
242 |             bot.send_message(call.message.chat.id, "‚ùå Erreur: √âchec du partage ou contenu hors limites.")
243 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
244 |     elif d[0] == "dl":
245 |         if d[1] == "no":
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:250:50
    |
248 |         elif d[1] == "yes":
249 |             try:
250 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                                  ^
251 |                 dl_data = ctx.get(str(call.message.chat.id) + "_dl")
252 |                 if not dl_data:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:292:36
    |
290 | @bot.message_handler(commands=['status'])
291 | def status_command(m):
292 |     if not is_authorized(m.chat.id): return
    |                                    ^
293 |     try:
294 |         nvme = shutil.disk_usage('/')
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:305:36
    |
303 | @bot.message_handler(commands=['films'])
304 | def films_command(m):
305 |     if not is_authorized(m.chat.id): return
    |                                    ^
306 |     try:
307 |         logging.info(f"[DEBUG_API] Interrogation Radarr √† {RADARR_CFG['url']}")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:322:36
    |
320 | @bot.message_handler(commands=['series'])
321 | def series_command(m):
322 |     if not is_authorized(m.chat.id): return
    |                                    ^
323 |     try:
324 |         r = requests.get(f"{SONARR_CFG['url']}/api/v3/series", headers={"X-Api-Key": SONARR_CFG['key']}, timeout=5)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:336:36
    |
334 | @bot.message_handler(commands=['queue'])
335 | def queue_command(m):
336 |     if not is_authorized(m.chat.id): return
    |                                    ^
337 |     
338 |     def clean_title(name):
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:346:24
    |
344 | ‚Ä¶     tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b', r‚Ä¶
345 | ‚Ä¶     clean = f"{title} ({year})" if year else title
346 | ‚Ä¶     for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
    |                      ^
347 | ‚Ä¶     return re.sub(r'\s+', ' ', clean).strip()
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:360:42
    |
358 |                     progress = round(t['progress'] * 100, 1)
359 |                     eta_sec = t['eta']
360 |                     if eta_sec >= 8640000: eta = "‚àû"
    |                                          ^
361 |                     else:
362 |                         eta = str(timedelta(seconds=eta_sec)).split(".")[0]
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:434:36
    |
432 | @bot.message_handler(commands=['get'])
433 | def handle_get_command_entry(m):
434 |     if not is_authorized(m.chat.id): return
    |                                    ^
435 |     parts = m.text.split(' ', 1)
436 |     if len(parts) > 1 and parts[1].strip():
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:444:36
    |
443 | def process_get_step(m):
444 |     if not is_authorized(m.chat.id): return
    |                                    ^
445 |     if m.text.startswith('/'):
446 |         return
    |

F841 Local variable `saison` is assigned to but never used
   --> infra/ai/maintenance/pi_bot_debug.py:467:9
    |
465 |         titre = str(data.get('titre'))
466 |         type_media = str(data.get('type'))
467 |         saison = int(data['saison']) if data.get('saison') is not None else None
    |         ^^^^^^
468 |         episode = int(data['episode']) if data.get('episode') is not None else None
469 |     except (ValueError, TypeError):
    |
help: Remove assignment to unused variable `saison`

F841 Local variable `episode` is assigned to but never used
   --> infra/ai/maintenance/pi_bot_debug.py:468:9
    |
466 |         type_media = str(data.get('type'))
467 |         saison = int(data['saison']) if data.get('saison') is not None else None
468 |         episode = int(data['episode']) if data.get('episode') is not None else None
    |         ^^^^^^^
469 |     except (ValueError, TypeError):
470 |         bot.reply_to(m, "‚ùå Erreur de formatage des m√©tadonn√©es extraites.")
    |
help: Remove assignment to unused variable `episode`

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:515:20
    |
513 |             ctx = {}
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
    |                    ^
516 |                 except: ctx = {}
517 |             ctx[str(m.chat.id) + "_dl"] = {
    |

E722 Do not use bare `except`
   --> infra/ai/maintenance/pi_bot_debug.py:516:17
    |
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
516 |                 except: ctx = {}
    |                 ^^^^^^
517 |             ctx[str(m.chat.id) + "_dl"] = {
518 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:516:23
    |
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
516 |                 except: ctx = {}
    |                       ^
517 |             ctx[str(m.chat.id) + "_dl"] = {
518 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:525:46
    |
523 |                 "images": item.get('images')
524 |             }
525 |             with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                              ^
526 |         except Exception as e:
527 |             logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:554:36
    |
552 | @bot.message_handler(func=lambda m: True)
553 | def handle_ai_request(m):
554 |     if not is_authorized(m.chat.id): return
    |                                    ^
555 |     if m.text.startswith('/'): return # Ignore native commands
556 |     process_get_request(m, m.text)
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/pi_bot_debug.py:555:30
    |
553 | def handle_ai_request(m):
554 |     if not is_authorized(m.chat.id): return
555 |     if m.text.startswith('/'): return # Ignore native commands
    |                              ^
556 |     process_get_request(m, m.text)
    |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/share_engine.py:17:41
   |
15 | def load_config():
16 |     try:
17 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
   |                                         ^
18 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/share_engine.py:18:5
   |
16 |     try:
17 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
18 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |     ^^^^^^
19 |
20 | def get_video_info(path):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/share_engine.py:18:11
   |
16 |     try:
17 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
18 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |           ^
19 |
20 | def get_video_info(path):
   |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/share_engine.py:116:36
    |
115 |     try:
116 |         if video_dest_path.exists(): video_dest_path.unlink()
    |                                    ^
117 |         os.symlink(src, video_dest_path)
118 |     except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/ai/maintenance/share_engine.py:133:38
    |
131 |         sub_dest_path = Path(SHARE_DIR) / sub_share_name
132 |         try:
133 |             if sub_dest_path.exists(): sub_dest_path.unlink()
    |                                      ^
134 |             os.symlink(sub, sub_dest_path)
135 |             result["subtitles"].append(f"{BASE_URL}/{sub_share_name}")
    |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:10:29
   |
 8 |     s = 0
 9 |     try:
10 |         if os.path.isfile(p): s = os.path.getsize(p)
   |                             ^
11 |         else:
12 |             for r, d, f in os.walk(p):
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:13:30
   |
11 |         else:
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
   |                              ^
14 |     except: return 0
15 |     return round(s / (1024**3), 2)
   |

E722 Do not use bare `except`
  --> infra/ai/maintenance/storage_manager.py:14:5
   |
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
14 |     except: return 0
   |     ^^^^^^
15 |     return round(s / (1024**3), 2)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:14:11
   |
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
14 |     except: return 0
   |           ^
15 |     return round(s / (1024**3), 2)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:18:32
   |
17 | def list_items(path):
18 |     if not os.path.exists(path): return f"‚ùå {path} absent."
   |                                ^
19 |     items = [f for f in os.listdir(path) if not f.startswith('.')]
20 |     out = f"üìÇ **{os.path.basename(path)}** :\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:29:21
   |
27 | if __name__ == "__main__":
28 |     arg = sys.argv[1] if len(sys.argv) > 1 else ""
29 |     if arg == "nvme": print(list_items(NVME_DIR))
   |                     ^
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
31 |     else: print("Commande re√ßue : " + arg)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:30:22
   |
28 |     arg = sys.argv[1] if len(sys.argv) > 1 else ""
29 |     if arg == "nvme": print(list_items(NVME_DIR))
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
   |                      ^
31 |     else: print("Commande re√ßue : " + arg)
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_manager.py:31:9
   |
29 |     if arg == "nvme": print(list_items(NVME_DIR))
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
31 |     else: print("Commande re√ßue : " + arg)
   |         ^
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_skill.py:11:32
   |
 9 | def list_media(category="movies"):
10 |     path = PATHS.get(category)
11 |     if not os.path.exists(path): return f"‚ùå Dossier {category} introuvable."
   |                                ^
12 |     items = [f for f in os.listdir(path) if not f.startswith('.')]
13 |     return f"üé• **{category.capitalize()} :**\n" + "\n".join([f"‚Ä¢ {i}" for i in sorted(items)]) if items else f"üìÇ Aucun contenu dans { ‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_skill.py:25:53
   |
23 |     if len(sys.argv) > 1:
24 |         cmd = sys.argv[1]
25 |         if cmd == "list_media" and len(sys.argv) > 2: print(list_media(sys.argv[2]))
   |                                                     ^
26 |         elif cmd == "get_status": print(get_status())
   |

E701 Multiple statements on one line (colon)
  --> infra/ai/maintenance/storage_skill.py:26:33
   |
24 |         cmd = sys.argv[1]
25 |         if cmd == "list_media" and len(sys.argv) > 2: print(list_media(sys.argv[2]))
26 |         elif cmd == "get_status": print(get_status())
   |                                 ^
   |

E701 Multiple statements on one line (colon)
  --> infra/config.py:30:26
   |
29 | def is_authorized(uid):
30 |     if uid == SUPER_ADMIN: return True
   |                          ^
31 |     try:
32 |         if not os.path.exists(USERS_FILE):
   |

F403 `from config import *` used; unable to detect undefined names
 --> infra/handlers_admin.py:5:1
  |
3 | import json
4 | from telebot import types
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 |
7 | def save_users(users):
  |

F405 `USERS_FILE` may be undefined, or defined from star imports
 --> infra/handlers_admin.py:8:15
  |
7 | def save_users(users):
8 |     with open(USERS_FILE, "w") as f:
  |               ^^^^^^^^^^
9 |         json.dump({"allowed": users}, f)
  |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:14:45
   |
12 |     @bot.message_handler(commands=['status'])
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
   |                                             ^
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
16 |         try:
   |

E731 Do not assign a `lambda` expression, use a `def`
  --> infra/handlers_admin.py:15:9
   |
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |         try:
17 |             nvme = shutil.disk_usage('/')
   |
help: Rewrite `fmt` as a `def`

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:30:45
   |
28 |     @bot.message_handler(commands=['admin'])
29 |     def admin_menu(m):
30 |         if not is_authorized(m.from_user.id): return
   |                                             ^
31 |         markup = types.InlineKeyboardMarkup(row_width=1)
32 |         markup.add(types.InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/handlers_admin.py:41:23
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:41:44
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_admin.py:43:34
   |
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |                                  ^
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:45:17
   |
43 |                 users.append(uid); save_users(users)
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |                 ^
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> infra/handlers_admin.py:46:9
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |         ^^^^^^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:46:15
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |               ^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:50:48
   |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
49 |     def admin_callback_router(call):
50 |         if not is_authorized(call.from_user.id): return
   |                                                ^
51 |         d = call.data.split(":")
52 |         cmd = d[1]
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/handlers_admin.py:67:23
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                     ^^^^^^^^^^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:67:44
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                          ^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/handlers_admin.py:74:23
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:74:44
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
  --> infra/handlers_admin.py:77:25
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                         ^^^^^^^^^^^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:77:36
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                                    ^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> infra/handlers_admin.py:83:23
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_admin.py:83:44
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

F403 `from config import *` used; unable to detect undefined names
  --> infra/handlers_media.py:9:1
   |
 7 | from datetime import timedelta
 8 | from telebot import types
 9 | from config import *
   | ^^^^^^^^^^^^^^^^^^^^
10 | import share_engine
   |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
  --> infra/handlers_media.py:19:38
   |
18 | def list_media_unified(bot, m, cat, title, is_edit=False):
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
   |                                      ^^^^^^^^^^^
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_media.py:21:39
   |
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_media.py:22:27
   |
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:23:16
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_media.py:23:39
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> infra/handlers_media.py:24:13
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |             ^^^^^^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:24:19
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |                   ^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_media.py:26:19
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
27 |     except: return
28 |     if not items:
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:26:42
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
27 |     except: return
28 |     if not items:
   |

E722 Do not use bare `except`
  --> infra/handlers_media.py:27:5
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |     ^^^^^^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:27:11
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |           ^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:30:19
   |
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
31 |         else: bot.send_message(m.chat.id, msg)
32 |         return
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:31:13
   |
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
31 |         else: bot.send_message(m.chat.id, msg)
   |             ^
32 |         return
33 |     text = f"{title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:34:36
   |
32 |         return
33 |     text = f"{title} : {cat}\n\n"
34 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
35 |     markup = types.InlineKeyboardMarkup(row_width=5)
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:38:15
   |
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:39:9
   |
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
40 |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_media.py:42:11
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |           ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_media.py:42:50
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |                                                  ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_media.py:46:29
   |
44 |     try:
45 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=10)
46 |         r.raise_for_status(); data = r.json()
   |                             ^
47 |         data.sort(key=lambda x: x.get('added', ''), reverse=True)
48 |         total = len(data)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:51:21
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                     ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_media.py:51:57
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                                                         ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:60:20
   |
58 |         markup.add(*btns)
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
   |                    ^
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:61:23
   |
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
   |                       ^
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:62:19
   |
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |                   ^
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:64:18
   |
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |                  ^
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:65:13
   |
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
   |             ^
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:66:26
   |
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |                          ^
67 |
68 | def register_media_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:71:36
   |
69 |     @bot.message_handler(commands=['films'])
70 |     def films_cmd(m):
71 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "films", 0, True, is_authorized)
   |                                    ^
72 |
73 |     @bot.message_handler(commands=['series'])
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:75:36
   |
73 |     @bot.message_handler(commands=['series'])
74 |     def series_cmd(m):
75 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "series", 0, True, is_authorized)
   |                                    ^
76 |
77 |     @bot.message_handler(commands=['queue'])
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:79:40
   |
77 |     @bot.message_handler(commands=['queue'])
78 |     def queue_command(m):
79 |         if not is_authorized(m.chat.id): return
   |                                        ^
80 |         def clean_title(name):
81 |             name = os.path.splitext(name)[0]
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:88:28
   |
86 | ‚Ä¶         tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b'‚Ä¶
87 | ‚Ä¶         clean = f"{title} ({year})" if year else title
88 | ‚Ä¶         for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
   |                          ^
89 | ‚Ä¶         return re.sub(r'\s+', ' ', clean).strip()
90 | ‚Ä¶     try:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_media.py:91:86
   |
89 |             return re.sub(r'\s+', ' ', clean).strip()
90 |         try:
91 |             r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
   |                                                                                      ^
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
93 |             q_text = "üì• **Queue :**\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_media.py:92:28
   |
90 |         try:
91 |             r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                            ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_media.py:92:62
   |
90 |         try:
91 |             r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                                                              ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E722 Do not use bare `except`
   --> infra/handlers_media.py:101:9
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |         ^^^^^^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:101:15
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |               ^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:105:48
    |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
104 |     def media_callback_router(call):
105 |         if not is_authorized(call.from_user.id): return
    |                                                ^
106 |         d = call.data.split(":")
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> infra/handlers_media.py:112:19
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                   ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> infra/handlers_media.py:112:53
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                     ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:117:40
    |
115 |             try:
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
    |                                        ^
118 |             except: pass
119 |             markup = types.InlineKeyboardMarkup()
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:118:13
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |             ^^^^^^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:118:19
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |                   ^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> infra/handlers_media.py:128:23
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                       ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> infra/handlers_media.py:128:57
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                         ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:139:33
    |
137 |                                 msg = f"‚úÖ **Lien de partage g√©n√©r√© :**\n\nüîó `{data['video']}`"
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
    |                                 ^
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:140:29
    |
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
    |                             ^
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:141:17
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                 ^^^^^^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:141:23
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                       ^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:142:17
    |
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |                 ^
143 |
144 |         elif d[0] == "sel":
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/handlers_media.py:146:27
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                           ^^^^^^^^^^^^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:146:50
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                  ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> infra/handlers_media.py:146:70
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                      ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
   --> infra/handlers_media.py:150:41
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                               ^^^^^^^^^^^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:150:52
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:153:13
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |             ^^^^^^
154 |         elif d[0] == "act":
155 |             try:
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:153:19
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |                   ^
154 |         elif d[0] == "act":
155 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/handlers_media.py:156:27
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                           ^^^^^^^^^^^^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:156:50
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                  ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/handlers_media.py:156:70
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                      ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
   --> infra/handlers_media.py:157:50
    |
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
    |                                                  ^^^^^^^^^^^
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:159:13
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |             ^^^^^^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:159:19
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                   ^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/handlers_media.py:162:27
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:162:50
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/handlers_media.py:162:70
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/handlers_media.py:163:49
    |
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                                 ^
164 |                 if subtitles:
165 |                     markup = types.InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:168:21
    |
166 | ‚Ä¶                 markup.add(types.InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), types.InlineKeyboardB‚Ä¶
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
    |                   ^
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
170 | ‚Ä¶     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:169:13
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |           ^^^^^^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:169:19
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                 ^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> infra/handlers_media.py:172:27
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:172:50
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/handlers_media.py:172:70
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:176:44
    |
174 | ‚Ä¶         bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
175 | ‚Ä¶         data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶         if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", parse ‚Ä¶
    |                                      ^
177 | ‚Ä¶         else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶     except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:177:21
    |
175 | ‚Ä¶             data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
    |                   ^
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/handlers_media.py:178:13
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |           ^^^^^^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:178:19
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |                 ^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/handlers_media.py:179:30
    |
177 |                 else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 |             except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 |         elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                              ^
    |

F403 `from config import *` used; unable to detect undefined names
 --> infra/handlers_search.py:7:1
  |
5 | import os
6 | from telebot.types import InlineKeyboardMarkup, InlineKeyboardButton
7 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
8 |
9 | def stream_gpt_json(query):
  |

F405 `OPENAI_KEY` may be undefined, or defined from star imports
  --> infra/handlers_search.py:10:79
   |
 9 | def stream_gpt_json(query):
10 |     headers = {"Content-Type": "application/json", "Authorization": f"Bearer {OPENAI_KEY}"}
   |                                                                               ^^^^^^^^^^
11 |     prompt = f"Analyse : '{query}'. Renvoie JSON : {{\"titre\": \"str\", \"type\": \"serie|film\"}}"
12 |     try:
   |

E722 Do not use bare `except`
  --> infra/handlers_search.py:15:5
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |     ^^^^^^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:15:11
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |           ^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:20:45
   |
18 |     @bot.message_handler(commands=['get'])
19 |     def handle_get(m):
20 |         if not is_authorized(m.from_user.id): return
   |                                             ^
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:22:26
   |
20 |         if not is_authorized(m.from_user.id): return
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |                          ^
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:23:13
   |
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |             ^
24 |
25 |     @bot.message_handler(func=lambda m: True)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:27:40
   |
25 |     @bot.message_handler(func=lambda m: True)
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
   |                                        ^
28 |         if m.text.startswith('/'): return
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:28:34
   |
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
28 |         if m.text.startswith('/'): return
   |                                  ^
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:33:48
   |
31 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("dl_sel:"))
32 |     def download_callback_handler(call):
33 |         if not is_authorized(call.from_user.id): return
   |                                                ^
34 |         d = call.data.split(":")
35 |         cat, idx = d[1], int(d[2])
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_search.py:37:23
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                       ^^^^^^^^^^^^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:37:46
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                                              ^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_search.py:44:19
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                   ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_search.py:44:53
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                                     ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:58:31
   |
56 |             }
57 |             payload[id_key] = item[id_key]
58 |             if cat == "series": payload["languageProfileId"] = 1
   |                               ^
59 |
60 |             r = requests.post(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, json=payload, timeout=10)
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_search.py:74:30
   |
72 |     try:
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
   |                              ^
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |

E722 Do not use bare `except`
  --> infra/handlers_search.py:75:5
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |     ^^^^^^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:75:11
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |           ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_search.py:75:26
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |                          ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_search.py:76:11
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |           ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> infra/handlers_search.py:76:45
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                             ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:80:23
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                       ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

E702 Multiple statements on one line (semicolon)
  --> infra/handlers_search.py:80:73
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                                                                          ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_search.py:82:27
   |
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:83:16
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_search.py:83:39
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

E722 Do not use bare `except`
  --> infra/handlers_search.py:84:13
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |             ^^^^^^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:84:19
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |                   ^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> infra/handlers_search.py:86:19
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:86:42
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:89:52
   |
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
89 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
   |                                                    ^
90 |         markup = InlineKeyboardMarkup()
91 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i-1}") for i in range(1, limit+1)]
   |

E722 Do not use bare `except`
  --> infra/handlers_search.py:94:5
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |     ^^^^^^
   |

E701 Multiple statements on one line (colon)
  --> infra/handlers_search.py:94:11
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |           ^
   |

F403 `from config import *` used; unable to detect undefined names
 --> infra/main.py:5:1
  |
3 | import logging
4 | from flask import Flask
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 | from handlers_admin import register_admin_handlers
7 | from handlers_media import register_media_handlers
  |

F405 `TOKEN` may be undefined, or defined from star imports
  --> infra/main.py:11:23
   |
10 | # --- CONFIGURATION PRINCIPALE ---
11 | bot = telebot.TeleBot(TOKEN)
   |                       ^^^^^
12 |
13 | # --- FLASK SERVER ---
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/main.py:32:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/main.py:33:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> infra/main.py:34:35
   |
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |                                   ^^^^^^^^^^^^^
35 |     
36 |     print("üöÄ Bot d√©marr√© en mode modulaire (Orchestrateur Clean)...")
   |

E722 Do not use bare `except`
  --> infra/monitoring/update_ips.py:10:5
   |
 8 |     try:
 9 |         return requests.get("https://api.ipify.org", timeout=5).text
10 |     except:
   |     ^^^^^^
11 |         return "Unknown"
   |

E722 Do not use bare `except`
  --> infra/monitoring/update_ips.py:18:5
   |
16 |         # Use wget as curl is missing in gluetun
17 |         vpn_ip = subprocess.check_output("docker exec gluetun wget -qO- https://api.ipify.org", shell=True).decode().strip()
18 |     except:
   |     ^^^^^^
19 |         vpn_ip = "Unknown"
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:32:8
   |
30 | # --- UTILS & STORAGE ---
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
33 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> infra/pi_bot.py:33:5
   |
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
33 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
34 |
35 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:33:11
   |
31 | def load_allowed_users():
32 |     try: return json.load(open(USERS_FILE))["allowed"]
33 |     except: return [SUPER_ADMIN]
   |           ^
34 |
35 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:42:94
   |
41 | def get_storage_emoji(item):
42 |     if not item.get('hasFile') and item.get('statistics', {}).get('episodeFileCount', 0) == 0: return "üî¥"
   |                                                                                              ^
43 |     path = item.get('path', '')
44 |     return "üìö" if path and "/mnt/externe" in path else "üöÄ"
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:49:37
   |
47 | @bot.message_handler(commands=['admin'])
48 | def admin_main(m):
49 |     if m.from_user.id != SUPER_ADMIN: return
   |                                     ^
50 |     markup = InlineKeyboardMarkup(row_width=1)
51 |     markup.add(InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

E702 Multiple statements on one line (semicolon)
  --> infra/pi_bot.py:62:30
   |
60 |         users = load_allowed_users()
61 |         if uid not in users:
62 |             users.append(uid); save_users(users)
   |                              ^
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:64:13
   |
62 |             users.append(uid); save_users(users)
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |             ^
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> infra/pi_bot.py:65:5
   |
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |     ^^^^^^
66 |
67 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:65:11
   |
63 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
64 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
65 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |           ^
66 |
67 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E702 Multiple statements on one line (semicolon)
  --> infra/pi_bot.py:71:39
   |
69 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
70 |     try:
71 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:73:16
   |
71 |         items = json.loads(res.stdout); ctx = {}
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
74 |             except: ctx = {}
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> infra/pi_bot.py:74:13
   |
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
74 |             except: ctx = {}
   |             ^^^^^^
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:74:19
   |
72 |         if os.path.exists(CONTEXT_FILE):
73 |             try: ctx = json.load(open(CONTEXT_FILE))
74 |             except: ctx = {}
   |                   ^
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:76:42
   |
74 |             except: ctx = {}
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
77 |     except: return
78 |     if not items:
   |

E722 Do not use bare `except`
  --> infra/pi_bot.py:77:5
   |
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
77 |     except: return
   |     ^^^^^^
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:77:11
   |
75 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
76 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
77 |     except: return
   |           ^
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:80:19
   |
78 |     if not items:
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
80 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
81 |         else: bot.send_message(m.chat.id, msg)
82 |         return
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:81:13
   |
79 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
80 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
81 |         else: bot.send_message(m.chat.id, msg)
   |             ^
82 |         return
83 |     text = f"üé¨ {title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:84:36
   |
82 |         return
83 |     text = f"üé¨ {title} : {cat}\n\n"
84 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
85 |     markup = InlineKeyboardMarkup(row_width=5)
86 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:88:15
   |
86 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
87 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
88 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
89 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot.py:89:9
   |
87 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
88 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
89 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
90 |
91 | # --- PAGED MEDIA UI (LIVE API) ---
   |

E702 Multiple statements on one line (semicolon)
  --> infra/pi_bot.py:97:29
   |
95 |     try:
96 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
97 |         r.raise_for_status(); data = r.json()
   |                             ^
98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
   |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:98:31
    |
 96 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
 97 |         r.raise_for_status(); data = r.json()
 98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
    |                               ^
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:99:13
    |
 97 |         r.raise_for_status(); data = r.json()
 98 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
    |             ^
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:101:27
    |
 99 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
100 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |                           ^
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:103:21
    |
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                     ^
104 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
105 |         for i, item in enumerate(items, 1):
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:103:59
    |
101 |         total = len(owned); start, end = page * 10, (page + 1) * 10
102 |         items = owned[start:end]
103 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                                                            ^
104 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
105 |         for i, item in enumerate(items, 1):
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:111:20
    |
109 |         markup.add(*btns)
110 |         nav = []
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
    |                    ^
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
113 |         if nav: markup.row(*nav)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:112:23
    |
110 |         nav = []
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
    |                       ^
113 |         if nav: markup.row(*nav)
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:113:15
    |
111 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
112 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
113 |         if nav: markup.row(*nav)
    |               ^
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:115:18
    |
113 |         if nav: markup.row(*nav)
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |                  ^
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:116:13
    |
114 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
    |             ^
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:117:5
    |
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |     ^^^^^^
118 |
119 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:117:11
    |
115 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
116 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
117 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |           ^
118 |
119 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:121:32
    |
119 | @bot.message_handler(commands=['films'])
120 | def films_cmd(m):
121 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "films", 0, True)
    |                                ^
122 |
123 | @bot.message_handler(commands=['series'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:125:32
    |
123 | @bot.message_handler(commands=['series'])
124 | def series_cmd(m):
125 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "series", 0, True)
    |                                ^
126 |
127 | # --- SEARCH ENGINE (/GET) ---
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:134:5
    |
132 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
133 |         return res.json()['choices'][0]['message']['content']
134 |     except: return None
    |     ^^^^^^
135 |
136 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:134:11
    |
132 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
133 |         return res.json()['choices'][0]['message']['content']
134 |     except: return None
    |           ^
135 |
136 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:138:36
    |
136 | @bot.message_handler(commands=['get'])
137 | def handle_get(m):
138 |     if not is_authorized(m.chat.id): return
    |                                    ^
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:140:22
    |
138 |     if not is_authorized(m.chat.id): return
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
    |                      ^
141 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:141:9
    |
139 |     parts = m.text.split(' ', 1)
140 |     if len(parts) > 1: process_get_request(m, parts[1])
141 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |         ^
142 |
143 | def process_get_request(m, query):
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:148:30
    |
146 |     try:
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
    |                              ^
149 |     except: titre = query; cat = "movie"
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:149:5
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |     ^^^^^^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:149:11
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |           ^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:149:26
    |
147 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
148 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
149 |     except: titre = query; cat = "movie"
    |                          ^
150 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
151 |     try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:154:23
    |
152 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
153 |         results = r.json()
154 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                       ^
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:154:73
    |
152 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
153 |         results = r.json()
154 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                                                                          ^
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:157:52
    |
155 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
156 |         limit = min(len(results), 5)
157 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
    |                                                    ^
158 |         markup = InlineKeyboardMarkup()
159 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i}") for i in range(1, limit+1)]
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:162:5
    |
160 |         markup.add(*btns)
161 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
162 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |     ^^^^^^
163 |
164 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:162:11
    |
160 |         markup.add(*btns)
161 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
162 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |           ^
163 |
164 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:167:44
    |
165 | @bot.callback_query_handler(func=lambda call: True)
166 | def master_router(call):
167 |     if not is_authorized(call.from_user.id): return
    |                                            ^
168 |     d = call.data.split(":")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:172:27
    |
170 |     # 1. New Paged UI Callbacks
171 |     if d[0] in ["m_pag", "m_sel", "m_act", "dl_sel"]:
172 |         if d[0] == "m_pag": show_media_list(call.message.chat.id, call.message.message_id, d[1], int(d[2]))
    |                           ^
173 |         elif d[0] == "m_sel":
174 |             markup = InlineKeyboardMarkup()
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:179:30
    |
177 | ‚Ä¶                    InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data=f"m_pag:{d[1]}:0"))
178 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
179 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
    |                            ^
180 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
181 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:180:29
    |
178 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
179 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
180 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
    |                           ^
181 | ‚Ä¶     return
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:199:41
    |
197 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
198 | ‚Ä¶     elif cmd == "users_list":
199 | ‚Ä¶         users = load_allowed_users(); text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
    |                                       ^
200 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=InlineKeyboardMarkup().add(InlineKe‚Ä¶
201 | ‚Ä¶     elif cmd == "users_add":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:205:41
    |
203 |             bot.register_next_step_handler(msg, process_user_add)
204 |         elif cmd == "users_rev":
205 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
    |                                         ^
206 |             for u in users:
207 |                 if u == SUPER_ADMIN: continue
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:207:36
    |
205 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
206 |             for u in users:
207 |                 if u == SUPER_ADMIN: continue
    |                                    ^
208 |                 markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
209 |             markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:212:28
    |
210 | ‚Ä¶         bot.edit_message_text("S√©lectionnez l'ID √† r√©voquer :", call.message.chat.id, call.message.message_id, reply_markup=markup)
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
    |                          ^
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:213:28
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                          ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:213:47
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                             ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:213:66
    |
211 | ‚Ä¶     elif cmd == "users_del":
212 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
213 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                                                ^
214 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
215 | ‚Ä¶     elif cmd == "share_owned":
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:219:33
    |
217 | ‚Ä¶         markup.add(InlineKeyboardButton("üé¨ Films", callback_data="adm:list_owned:movies"), InlineKeyboardButton("üì∫ S√©ries", callba ‚Ä¶
218 | ‚Ä¶         bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
219 | ‚Ä¶     elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
    |                               ^
220 | ‚Ä¶     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
221 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:220:28
    |
218 |             bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
219 |         elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
220 |         elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                            ^
221 |         return
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:226:46
    |
224 |     if d[0] == "sel":
225 |         try:
226 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                              ^
227 |             markup = InlineKeyboardMarkup(row_width=2)
228 |             act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:226:66
    |
224 |     if d[0] == "sel":
225 |         try:
226 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                  ^
227 |             markup = InlineKeyboardMarkup(row_width=2)
228 |             act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:230:48
    |
228 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
229 | ‚Ä¶     markup.add(InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), InlineKeyboardButton("üóëÔ∏è Supprimer"‚Ä¶
230 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
231 | ‚Ä¶     markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:233:9
    |
231 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
233 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |         ^^^^^^
234 |     elif d[0] == "act":
235 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:233:15
    |
231 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
232 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
233 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |               ^
234 |     elif d[0] == "act":
235 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:236:46
    |
234 |     elif d[0] == "act":
235 |         try:
236 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                              ^
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:236:66
    |
234 |     elif d[0] == "act":
235 |         try:
236 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                  ^
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:239:9
    |
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
239 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
240 |     elif d[0] == "share_exec":
241 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:239:15
    |
237 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
238 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
239 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
240 |     elif d[0] == "share_exec":
241 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:242:46
    |
240 |     elif d[0] == "share_exec":
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
244 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:242:66
    |
240 |     elif d[0] == "share_exec":
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
244 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:243:45
    |
241 |         try:
242 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
243 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                             ^
244 |             if subtitles:
245 |                 markup = InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:248:17
    |
246 |                 markup.add(InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), InlineKeyboardButton("üé¨ Remu ‚Ä¶
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
    |                 ^
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
250 |     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:249:9
    |
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
250 |     elif d[0] == "share_final":
251 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:249:15
    |
247 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
248 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
249 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
250 |     elif d[0] == "share_final":
251 |         try:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:252:46
    |
250 |     elif d[0] == "share_final":
251 |         try:
252 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
253 |             remux_opt = True if d[2] == "remux" else False
254 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:252:66
    |
250 |     elif d[0] == "share_final":
251 |         try:
252 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
253 |             remux_opt = True if d[2] == "remux" else False
254 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:259:17
    |
257 |                 msg = f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`"
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
    |                 ^
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:260:9
    |
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |         ^^^^^^
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:260:15
    |
258 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |               ^
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:261:26
    |
259 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
260 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
261 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
262 |
263 | # --- STATUS & QUEUE ---
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:266:36
    |
264 | @bot.message_handler(commands=['status'])
265 | def status_command(m):
266 |     if not is_authorized(m.chat.id): return
    |                                    ^
267 |     try:
268 |         nvme = shutil.disk_usage('/')
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:275:5
    |
273 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
274 |         bot.reply_to(m, msg, parse_mode='Markdown')
275 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |     ^^^^^^
276 |
277 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:275:11
    |
273 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
274 |         bot.reply_to(m, msg, parse_mode='Markdown')
275 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |           ^
276 |
277 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:279:36
    |
277 | @bot.message_handler(commands=['queue'])
278 | def queue_command(m):
279 |     if not is_authorized(m.chat.id): return
    |                                    ^
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:281:82
    |
279 |     if not is_authorized(m.chat.id): return
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |                                                                                  ^
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
283 |         q_text = "üì• **Queue :**\n\n"
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:282:24
    |
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                        ^
283 |         q_text = "üì• **Queue :**\n\n"
284 |         for t in torrents:
    |

E702 Multiple statements on one line (semicolon)
   --> infra/pi_bot.py:282:58
    |
280 |     try:
281 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
282 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                                                          ^
283 |         q_text = "üì• **Queue :**\n\n"
284 |         for t in torrents:
    |

E722 Do not use bare `except`
   --> infra/pi_bot.py:289:5
    |
287 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
288 |         bot.reply_to(m, q_text, parse_mode='Markdown')
289 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |     ^^^^^^
290 |
291 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot.py:289:11
    |
287 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
288 |         bot.reply_to(m, q_text, parse_mode='Markdown')
289 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |           ^
290 |
291 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot_debug.py:34:8
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
35 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> infra/pi_bot_debug.py:35:5
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
35 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
36 |
37 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot_debug.py:35:11
   |
33 | def load_allowed_users():
34 |     try: return json.load(open(USERS_FILE))["allowed"]
35 |     except: return [SUPER_ADMIN]
   |           ^
36 |
37 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot_debug.py:58:40
   |
56 | @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
57 | def admin_router(call):
58 |     if call.from_user.id != SUPER_ADMIN: return
   |                                        ^
59 |     parts = call.data.split(":")
60 |     cmd = parts[1]
   |

E701 Multiple statements on one line (colon)
  --> infra/pi_bot_debug.py:94:32
   |
92 |         markup = InlineKeyboardMarkup(row_width=1)
93 |         for u in users:
94 |             if u == SUPER_ADMIN: continue
   |                                ^
95 |             markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
96 |         markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:122:24
    |
120 |         bot.edit_message_text("üßπ **Nettoyage SSD**\n\nFonctionnalit√© en cours de d√©veloppement.", call.message.chat.id, call.message.‚Ä¶
121 |     
122 |     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                        ^
123 |
124 | def process_user_add(m):
    |

E722 Do not use bare `except`
   --> infra/pi_bot_debug.py:134:5
    |
132 |         else:
133 |             bot.reply_to(m, "‚ÑπÔ∏è Cet utilisateur est d√©j√† autoris√©.")
134 |     except:
    |     ^^^^^^
135 |         bot.reply_to(m, "‚ùå ID invalide. Veuillez envoyer un nombre.")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:144:16
    |
142 |         ctx = {}
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
    |                ^
145 |             except: ctx = {}
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
    |

E722 Do not use bare `except`
   --> infra/pi_bot_debug.py:145:13
    |
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
145 |             except: ctx = {}
    |             ^^^^^^
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:145:19
    |
143 |         if os.path.exists(CONTEXT_FILE):
144 |             try: ctx = json.load(open(CONTEXT_FILE))
145 |             except: ctx = {}
    |                   ^
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:147:42
    |
145 |             except: ctx = {}
146 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
147 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                          ^
148 |     except Exception as e:
149 |         logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:153:19
    |
151 |     if not items:
152 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
153 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
    |                   ^
154 |         else: bot.send_message(m.chat.id, msg)
155 |         return
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:154:13
    |
152 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
153 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
154 |         else: bot.send_message(m.chat.id, msg)
    |             ^
155 |         return
156 |     text = f"üé¨ {title} : {cat}\n\n"
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:157:36
    |
155 |         return
156 |     text = f"üé¨ {title} : {cat}\n\n"
157 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
    |                                    ^
158 |     markup = InlineKeyboardMarkup(row_width=5)
159 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:161:15
    |
159 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
160 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
161 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
    |               ^
162 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:162:9
    |
160 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
161 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
162 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |         ^
163 |
164 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:166:44
    |
164 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
165 | def media_callbacks(call):
166 |     if not is_authorized(call.from_user.id): return
    |                                            ^
167 |     d = call.data.split(":")
168 |     if d[0] == "sel":
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:170:46
    |
168 |     if d[0] == "sel":
169 |         try:
170 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
171 |             item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
172 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:186:46
    |
184 |     elif d[0] == "act":
185 |         try:
186 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
187 |             item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
188 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:196:46
    |
194 |     elif d[0] == "share_exec":
195 |         try:
196 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
197 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
198 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:219:46
    |
217 |     elif d[0] == "share_final":
218 |         try:
219 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
220 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
221 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:243:26
    |
241 |         else:
242 |             bot.send_message(call.message.chat.id, "‚ùå Erreur: √âchec du partage ou contenu hors limites.")
243 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
244 |     elif d[0] == "dl":
245 |         if d[1] == "no":
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:250:50
    |
248 |         elif d[1] == "yes":
249 |             try:
250 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                                  ^
251 |                 dl_data = ctx.get(str(call.message.chat.id) + "_dl")
252 |                 if not dl_data:
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:292:36
    |
290 | @bot.message_handler(commands=['status'])
291 | def status_command(m):
292 |     if not is_authorized(m.chat.id): return
    |                                    ^
293 |     try:
294 |         nvme = shutil.disk_usage('/')
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:305:36
    |
303 | @bot.message_handler(commands=['films'])
304 | def films_command(m):
305 |     if not is_authorized(m.chat.id): return
    |                                    ^
306 |     try:
307 |         logging.info(f"[DEBUG_API] Interrogation Radarr √† {RADARR_CFG['url']}")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:322:36
    |
320 | @bot.message_handler(commands=['series'])
321 | def series_command(m):
322 |     if not is_authorized(m.chat.id): return
    |                                    ^
323 |     try:
324 |         r = requests.get(f"{SONARR_CFG['url']}/api/v3/series", headers={"X-Api-Key": SONARR_CFG['key']}, timeout=5)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:336:36
    |
334 | @bot.message_handler(commands=['queue'])
335 | def queue_command(m):
336 |     if not is_authorized(m.chat.id): return
    |                                    ^
337 |     
338 |     def clean_title(name):
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:346:24
    |
344 | ‚Ä¶     tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b', r‚Ä¶
345 | ‚Ä¶     clean = f"{title} ({year})" if year else title
346 | ‚Ä¶     for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
    |                      ^
347 | ‚Ä¶     return re.sub(r'\s+', ' ', clean).strip()
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:360:42
    |
358 |                     progress = round(t['progress'] * 100, 1)
359 |                     eta_sec = t['eta']
360 |                     if eta_sec >= 8640000: eta = "‚àû"
    |                                          ^
361 |                     else:
362 |                         eta = str(timedelta(seconds=eta_sec)).split(".")[0]
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:434:36
    |
432 | @bot.message_handler(commands=['get'])
433 | def handle_get_command_entry(m):
434 |     if not is_authorized(m.chat.id): return
    |                                    ^
435 |     parts = m.text.split(' ', 1)
436 |     if len(parts) > 1 and parts[1].strip():
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:444:36
    |
443 | def process_get_step(m):
444 |     if not is_authorized(m.chat.id): return
    |                                    ^
445 |     if m.text.startswith('/'):
446 |         return
    |

F841 Local variable `saison` is assigned to but never used
   --> infra/pi_bot_debug.py:467:9
    |
465 |         titre = str(data.get('titre'))
466 |         type_media = str(data.get('type'))
467 |         saison = int(data['saison']) if data.get('saison') is not None else None
    |         ^^^^^^
468 |         episode = int(data['episode']) if data.get('episode') is not None else None
469 |     except (ValueError, TypeError):
    |
help: Remove assignment to unused variable `saison`

F841 Local variable `episode` is assigned to but never used
   --> infra/pi_bot_debug.py:468:9
    |
466 |         type_media = str(data.get('type'))
467 |         saison = int(data['saison']) if data.get('saison') is not None else None
468 |         episode = int(data['episode']) if data.get('episode') is not None else None
    |         ^^^^^^^
469 |     except (ValueError, TypeError):
470 |         bot.reply_to(m, "‚ùå Erreur de formatage des m√©tadonn√©es extraites.")
    |
help: Remove assignment to unused variable `episode`

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:515:20
    |
513 |             ctx = {}
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
    |                    ^
516 |                 except: ctx = {}
517 |             ctx[str(m.chat.id) + "_dl"] = {
    |

E722 Do not use bare `except`
   --> infra/pi_bot_debug.py:516:17
    |
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
516 |                 except: ctx = {}
    |                 ^^^^^^
517 |             ctx[str(m.chat.id) + "_dl"] = {
518 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:516:23
    |
514 |             if os.path.exists(CONTEXT_FILE):
515 |                 try: ctx = json.load(open(CONTEXT_FILE))
516 |                 except: ctx = {}
    |                       ^
517 |             ctx[str(m.chat.id) + "_dl"] = {
518 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:525:46
    |
523 |                 "images": item.get('images')
524 |             }
525 |             with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                              ^
526 |         except Exception as e:
527 |             logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:554:36
    |
552 | @bot.message_handler(func=lambda m: True)
553 | def handle_ai_request(m):
554 |     if not is_authorized(m.chat.id): return
    |                                    ^
555 |     if m.text.startswith('/'): return # Ignore native commands
556 |     process_get_request(m, m.text)
    |

E701 Multiple statements on one line (colon)
   --> infra/pi_bot_debug.py:555:30
    |
553 | def handle_ai_request(m):
554 |     if not is_authorized(m.chat.id): return
555 |     if m.text.startswith('/'): return # Ignore native commands
    |                              ^
556 |     process_get_request(m, m.text)
    |

E722 Do not use bare `except`
   --> scripts/cleanup_share.py:122:18
    |
120 |                      shutil.move(dest_path, file_path)
121 |                      logging.info(f"Rollback r√©ussi pour {file_path}")
122 |                  except:
    |                  ^^^^^^
123 |                      pass
    |

E701 Multiple statements on one line (colon)
   --> scripts/cleanup_share.py:142:36
    |
141 |         for item in os.listdir(hdd_dir):
142 |             if item.startswith('.'): continue
    |                                    ^
143 |             
144 |             hdd_item_path = os.path.join(hdd_dir, item)
    |

E701 Multiple statements on one line (colon)
  --> scripts/config.py:40:26
   |
39 | def is_authorized(uid):
40 |     if uid == SUPER_ADMIN: return True
   |                          ^
41 |     try:
42 |         if not os.path.exists(USERS_FILE):
   |

F403 `from config import *` used; unable to detect undefined names
 --> scripts/handlers_admin.py:5:1
  |
3 | import json
4 | from telebot import types
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 |
7 | def save_users(users):
  |

F405 `USERS_FILE` may be undefined, or defined from star imports
 --> scripts/handlers_admin.py:8:15
  |
7 | def save_users(users):
8 |     with open(USERS_FILE, "w") as f:
  |               ^^^^^^^^^^
9 |         json.dump({"allowed": users}, f)
  |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:14:45
   |
12 |     @bot.message_handler(commands=['status'])
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
   |                                             ^
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
16 |         try:
   |

E731 Do not assign a `lambda` expression, use a `def`
  --> scripts/handlers_admin.py:15:9
   |
13 |     def status_cmd(m):
14 |         if not is_authorized(m.from_user.id): return
15 |         fmt = lambda u: f"{u.used/(1024**3):.1f}/{u.total/(1024**3):.1f}Go ({int(u.used/u.total*100)}%)"
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |         try:
17 |             nvme = shutil.disk_usage('/')
   |
help: Rewrite `fmt` as a `def`

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:30:45
   |
28 |     @bot.message_handler(commands=['admin'])
29 |     def admin_menu(m):
30 |         if not is_authorized(m.from_user.id): return
   |                                             ^
31 |         markup = types.InlineKeyboardMarkup(row_width=1)
32 |         markup.add(types.InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_admin.py:41:23
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:41:44
   |
39 |         try:
40 |             uid = int(m.text)
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_admin.py:43:34
   |
41 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
42 |             if uid not in users:
43 |                 users.append(uid); save_users(users)
   |                                  ^
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:45:17
   |
43 |                 users.append(uid); save_users(users)
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |                 ^
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> scripts/handlers_admin.py:46:9
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |         ^^^^^^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:46:15
   |
44 |                 bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
45 |             else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
46 |         except: bot.reply_to(m, "‚ùå ID invalide.")
   |               ^
47 |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:50:48
   |
48 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
49 |     def admin_callback_router(call):
50 |         if not is_authorized(call.from_user.id): return
   |                                                ^
51 |         d = call.data.split(":")
52 |         cmd = d[1]
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_admin.py:67:23
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                     ^^^^^^^^^^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:67:44
   |
65 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
66 | ‚Ä¶     elif cmd == "users_list":
67 | ‚Ä¶         with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                          ^
68 | ‚Ä¶         text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
69 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=types.InlineKeyboardMarkup().add(typ‚Ä¶
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_admin.py:74:23
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:74:44
   |
72 |             bot.register_next_step_handler(msg, process_user_add)
73 |         elif cmd == "users_rev":
74 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
   |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
  --> scripts/handlers_admin.py:77:25
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                         ^^^^^^^^^^^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:77:36
   |
75 |             markup = types.InlineKeyboardMarkup(row_width=1)
76 |             for u in users:
77 |                 if u == SUPER_ADMIN: continue
   |                                    ^
78 |                 markup.add(types.InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
79 |             markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

F405 `USERS_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_admin.py:83:23
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                       ^^^^^^^^^^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_admin.py:83:44
   |
81 |         elif cmd == "users_del":
82 |             uid = int(d[2])
83 |             with open(USERS_FILE, 'r') as f: users = json.load(f)["allowed"]
   |                                            ^
84 |             if uid in users:
85 |                 users.remove(uid)
   |

F403 `from config import *` used; unable to detect undefined names
  --> scripts/handlers_media.py:9:1
   |
 7 | from datetime import timedelta
 8 | from telebot import types
 9 | from config import *
   | ^^^^^^^^^^^^^^^^^^^^
10 | import share_engine
   |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:19:38
   |
18 | def list_media_unified(bot, m, cat, title, is_edit=False):
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
   |                                      ^^^^^^^^^^^
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_media.py:21:39
   |
19 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:22:27
   |
20 |     try:
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:23:16
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:23:39
   |
21 |         items = json.loads(res.stdout); ctx = {}
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> scripts/handlers_media.py:24:13
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |             ^^^^^^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:24:19
   |
22 |         if os.path.exists(CONTEXT_FILE):
23 |             try: ctx = json.load(open(CONTEXT_FILE))
24 |             except: ctx = {}
   |                   ^
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:26:19
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
27 |     except: return
28 |     if not items:
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:26:42
   |
24 |             except: ctx = {}
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
27 |     except: return
28 |     if not items:
   |

E722 Do not use bare `except`
  --> scripts/handlers_media.py:27:5
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |     ^^^^^^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:27:11
   |
25 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
26 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
27 |     except: return
   |           ^
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:30:19
   |
28 |     if not items:
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
31 |         else: bot.send_message(m.chat.id, msg)
32 |         return
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:31:13
   |
29 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
30 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
31 |         else: bot.send_message(m.chat.id, msg)
   |             ^
32 |         return
33 |     text = f"{title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:34:36
   |
32 |         return
33 |     text = f"{title} : {cat}\n\n"
34 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
35 |     markup = types.InlineKeyboardMarkup(row_width=5)
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:38:15
   |
36 |     markup.add(*[types.InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:39:9
   |
37 |     markup.add(types.InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
38 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
39 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
40 |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:42:11
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |           ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:42:50
   |
41 | def show_media_list(bot, chat_id, message_id, category, page=0, is_new=False, is_authorized=None):
42 |     cfg = RADARR_CFG if category == "films" else SONARR_CFG
   |                                                  ^^^^^^^^^^
43 |     endpoint = "movie" if category == "films" else "series"
44 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_media.py:46:29
   |
44 |     try:
45 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=10)
46 |         r.raise_for_status(); data = r.json()
   |                             ^
47 |         data.sort(key=lambda x: x.get('added', ''), reverse=True)
48 |         total = len(data)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:51:21
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                     ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_media.py:51:57
   |
49 |         start, end = page * 10, (page + 1) * 10
50 |         items = data[start:end]
51 |         if not items: bot.send_message(chat_id, "Vide."); return
   |                                                         ^
52 |         text = f"**{category.capitalize()} ({total})**\n\n"
53 |         for i, item in enumerate(items, 1):
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:60:20
   |
58 |         markup.add(*btns)
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
   |                    ^
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:61:23
   |
59 |         nav_row = []
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
   |                       ^
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:62:19
   |
60 |         if page > 0: nav_row.append(types.InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
61 |         if end < total: nav_row.append(types.InlineKeyboardButton(f"‚û°Ô∏è ({total-end})", callback_data=f"m_pag:{category}:{page+1}"))
62 |         if nav_row: markup.row(*nav_row)
   |                   ^
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:64:18
   |
62 |         if nav_row: markup.row(*nav_row)
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
   |                  ^
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:65:13
   |
63 |         markup.add(types.InlineKeyboardButton("üè† Menu Admin", callback_data="adm:main"))
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
   |             ^
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:66:26
   |
64 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
65 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
66 |     except Exception as e: bot.send_message(chat_id, f"‚ùå Erreur API : {e}")
   |                          ^
67 |
68 | def register_media_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:71:36
   |
69 |     @bot.message_handler(commands=['films'])
70 |     def films_cmd(m):
71 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "films", 0, True, is_authorized)
   |                                    ^
72 |
73 |     @bot.message_handler(commands=['series'])
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:75:36
   |
73 |     @bot.message_handler(commands=['series'])
74 |     def series_cmd(m):
75 |         if is_authorized(m.chat.id): show_media_list(bot, m.chat.id, None, "series", 0, True, is_authorized)
   |                                    ^
76 |
77 |     @bot.message_handler(commands=['queue'])
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:79:40
   |
77 |     @bot.message_handler(commands=['queue'])
78 |     def queue_command(m):
79 |         if not is_authorized(m.chat.id): return
   |                                        ^
80 |         def clean_title(name):
81 |             name = os.path.splitext(name)[0]
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:88:28
   |
86 | ‚Ä¶         tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b'‚Ä¶
87 | ‚Ä¶         clean = f"{title} ({year})" if year else title
88 | ‚Ä¶         for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
   |                          ^
89 | ‚Ä¶         return re.sub(r'\s+', ' ', clean).strip()
90 | ‚Ä¶     try:
   |

F405 `QBIT_URL` may be undefined, or defined from star imports
  --> scripts/handlers_media.py:91:33
   |
89 |             return re.sub(r'\s+', ' ', clean).strip()
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
   |                                 ^^^^^^^^
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
93 |             q_text = "üì• **Queue :**\n\n"
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_media.py:91:76
   |
89 |             return re.sub(r'\s+', ' ', clean).strip()
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
   |                                                                            ^
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
93 |             q_text = "üì• **Queue :**\n\n"
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_media.py:92:28
   |
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                            ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_media.py:92:62
   |
90 |         try:
91 |             r = requests.get(f"{QBIT_URL}/api/v2/torrents/info", timeout=5); torrents = r.json()
92 |             if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
   |                                                              ^
93 |             q_text = "üì• **Queue :**\n\n"
94 |             for t in torrents:
   |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:101:9
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |         ^^^^^^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:101:15
    |
 99 |                     q_text += f"‚Ä¢ **{clean_name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB | ‚è≥ {eta  ‚Ä¶
100 |             bot.reply_to(m, q_text, parse_mode='Markdown')
101 |         except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |               ^
102 |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:105:48
    |
103 |     @bot.callback_query_handler(func=lambda call: call.data.startswith(("m_pag", "m_sel", "m_act", "sel", "act", "share_exec", "share‚Ä¶
104 |     def media_callback_router(call):
105 |         if not is_authorized(call.from_user.id): return
    |                                                ^
106 |         d = call.data.split(":")
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:112:19
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                   ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:112:53
    |
110 |         elif d[0] == "m_sel":
111 |             cat, item_id = d[1], d[2]
112 |             cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                     ^^^^^^^^^^
113 |             endpoint = "movie" if cat == "films" else "series"
114 |             display_title = f"ID {item_id}"
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:117:40
    |
115 |             try:
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
    |                                        ^
118 |             except: pass
119 |             markup = types.InlineKeyboardMarkup()
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:118:13
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |             ^^^^^^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:118:19
    |
116 |                 r = requests.get(f"{cfg['url']}/api/v3/{endpoint}/{item_id}", headers={"X-Api-Key": cfg['key']}, timeout=5)
117 |                 if r.status_code == 200: display_title = r.json().get('title', display_title)
118 |             except: pass
    |                   ^
119 |             markup = types.InlineKeyboardMarkup()
120 |             markup.add(types.InlineKeyboardButton("üóëÔ∏è Supprimer", callback_data=f"m_act:del:{d[1]}:{d[2]}"),
    |

F405 `RADARR_CFG` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:128:23
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                       ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

F405 `SONARR_CFG` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:128:57
    |
126 |             if action == "share":
127 |                 bot.answer_callback_query(call.id, "‚è≥ G√©n√©ration du lien...")
128 |                 cfg = RADARR_CFG if cat == "films" else SONARR_CFG
    |                                                         ^^^^^^^^^^
129 |                 endpoint = "movie" if cat == "films" else "series"
130 |                 try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:139:33
    |
137 |                                 msg = f"‚úÖ **Lien de partage g√©n√©r√© :**\n\nüîó `{data['video']}`"
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
    |                                 ^
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:140:29
    |
138 |                                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
    |                             ^
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:141:17
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                 ^^^^^^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:141:23
    |
139 |                             else: bot.send_message(call.message.chat.id, "‚ùå √âchec lien.")
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
    |                       ^
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:142:17
    |
140 |                         else: bot.send_message(call.message.chat.id, "‚ùå Chemin absent.")
141 |                 except: bot.send_message(call.message.chat.id, "‚ùå Erreur API.")
142 |             else: bot.answer_callback_query(call.id, f"Action {action} ok.")
    |                 ^
143 |
144 |         elif d[0] == "sel":
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:146:27
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                           ^^^^^^^^^^^^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:146:50
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                  ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/handlers_media.py:146:70
    |
144 |         elif d[0] == "sel":
145 |             try:
146 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                      ^
147 |                 markup = types.InlineKeyboardMarkup(row_width=2)
148 |                 act = "arc" if item['is_nvme'] else "res"
    |

F405 `SUPER_ADMIN` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:150:41
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                               ^^^^^^^^^^^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:150:52
    |
148 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
149 | ‚Ä¶     markup.add(types.InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), types.InlineKeyboardButton("üóë‚Ä¶
150 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(types.InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
151 | ‚Ä¶     markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:153:13
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |             ^^^^^^
154 |         elif d[0] == "act":
155 |             try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:153:19
    |
151 |                 markup.add(types.InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
152 |                 bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
153 |             except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |                   ^
154 |         elif d[0] == "act":
155 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:156:27
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                           ^^^^^^^^^^^^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:156:50
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                  ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/handlers_media.py:156:70
    |
154 |         elif d[0] == "act":
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                      ^
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

F405 `SCRIPT_PATH` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:157:50
    |
155 |             try:
156 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
    |                                                  ^^^^^^^^^^^
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:159:13
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |             ^^^^^^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:159:19
    |
157 |                 res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
158 |                 bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
159 |             except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                   ^
160 |         elif d[0] == "share_exec":
161 |             try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:162:27
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:162:50
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/handlers_media.py:162:70
    |
160 |         elif d[0] == "share_exec":
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
164 |                 if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/handlers_media.py:163:49
    |
161 |             try:
162 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
163 |                 src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                                 ^
164 |                 if subtitles:
165 |                     markup = types.InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:168:21
    |
166 | ‚Ä¶                 markup.add(types.InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), types.InlineKeyboardB‚Ä¶
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
    |                   ^
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
170 | ‚Ä¶     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:169:13
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |           ^^^^^^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:169:19
    |
167 | ‚Ä¶                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.m‚Ä¶
168 | ‚Ä¶             else: media_callback_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"shar‚Ä¶
169 | ‚Ä¶         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |                 ^
170 | ‚Ä¶     elif d[0] == "share_final":
171 | ‚Ä¶         try:
    |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
   --> scripts/handlers_media.py:172:27
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                           ^^^^^^^^^^^^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:172:50
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                  ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/handlers_media.py:172:70
    |
170 |         elif d[0] == "share_final":
171 |             try:
172 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                      ^
173 |                 remux_opt = True if d[2] == "remux" else False
174 |                 bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:176:44
    |
174 | ‚Ä¶         bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
175 | ‚Ä¶         data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶         if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", parse ‚Ä¶
    |                                      ^
177 | ‚Ä¶         else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶     except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:177:21
    |
175 | ‚Ä¶             data = share_engine.generate_secure_link(item['path'], remux=remux_opt)
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
    |                   ^
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> scripts/handlers_media.py:178:13
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |           ^^^^^^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:178:19
    |
176 | ‚Ä¶             if data and "video" in data: bot.send_message(call.message.chat.id, f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`", p ‚Ä¶
177 | ‚Ä¶             else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 | ‚Ä¶         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |                 ^
179 | ‚Ä¶     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/handlers_media.py:179:30
    |
177 |                 else: bot.send_message(call.message.chat.id, "‚ùå √âchec.")
178 |             except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
179 |         elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                              ^
    |

F403 `from config import *` used; unable to detect undefined names
 --> scripts/handlers_search.py:7:1
  |
5 | import os
6 | from telebot.types import InlineKeyboardMarkup, InlineKeyboardButton
7 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
8 |
9 | def stream_gpt_json(query):
  |

F405 `OPENAI_KEY` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:10:79
   |
 9 | def stream_gpt_json(query):
10 |     headers = {"Content-Type": "application/json", "Authorization": f"Bearer {OPENAI_KEY}"}
   |                                                                               ^^^^^^^^^^
11 |     prompt = f"Analyse : '{query}'. Renvoie JSON : {{\"titre\": \"str\", \"type\": \"serie|film\"}}"
12 |     try:
   |

E722 Do not use bare `except`
  --> scripts/handlers_search.py:15:5
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |     ^^^^^^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:15:11
   |
13 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": [‚Ä¶
14 |         return res.json()['choices'][0]['message']['content']
15 |     except: return None
   |           ^
16 |
17 | def register_search_handlers(bot, is_authorized):
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:20:45
   |
18 |     @bot.message_handler(commands=['get'])
19 |     def handle_get(m):
20 |         if not is_authorized(m.from_user.id): return
   |                                             ^
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:22:26
   |
20 |         if not is_authorized(m.from_user.id): return
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
   |                          ^
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:23:13
   |
21 |         parts = m.text.split(' ', 1)
22 |         if len(parts) > 1: process_get_request(bot, m, parts[1])
23 |         else: bot.reply_to(m, "üé¨ Que veux-tu ? (Ex: /get Titanic)")
   |             ^
24 |
25 |     @bot.message_handler(func=lambda m: True)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:27:40
   |
25 |     @bot.message_handler(func=lambda m: True)
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
   |                                        ^
28 |         if m.text.startswith('/'): return
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:28:34
   |
26 |     def handle_ai_request(m):
27 |         if not is_authorized(m.chat.id): return
28 |         if m.text.startswith('/'): return
   |                                  ^
29 |         process_get_request(bot, m, m.text)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:33:48
   |
31 |     @bot.callback_query_handler(func=lambda call: call.data.startswith("dl_sel:"))
32 |     def download_callback_handler(call):
33 |         if not is_authorized(call.from_user.id): return
   |                                                ^
34 |         d = call.data.split(":")
35 |         cat, idx = d[1], int(d[2])
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:37:23
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                       ^^^^^^^^^^^^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:37:46
   |
35 |         cat, idx = d[1], int(d[2])
36 |         try:
37 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
   |                                              ^
38 |             search_data = ctx.get(f"{call.message.chat.id}_search")
39 |             if not search_data:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:44:19
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                   ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:44:53
   |
43 |             item = search_data['results'][idx]
44 |             cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                                     ^^^^^^^^^^
45 |             endpoint = "movie" if cat == "movie" else "series"
46 |             id_key = "tmdbId" if cat == "movie" else "tvdbId"
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:58:31
   |
56 |             }
57 |             payload[id_key] = item[id_key]
58 |             if cat == "series": payload["languageProfileId"] = 1
   |                               ^
59 |
60 |             r = requests.post(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, json=payload, timeout=10)
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_search.py:74:30
   |
72 |     try:
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
   |                              ^
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |

E722 Do not use bare `except`
  --> scripts/handlers_search.py:75:5
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |     ^^^^^^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:75:11
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |           ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_search.py:75:26
   |
73 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
   |                          ^
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
77 |     try:
   |

F405 `RADARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:76:11
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |           ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

F405 `SONARR_CFG` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:76:45
   |
74 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
75 |     except: titre = query; cat = "movie"
76 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
   |                                             ^^^^^^^^^^
77 |     try:
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:80:23
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                       ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/handlers_search.py:80:73
   |
78 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
79 |         results = r.json()
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
   |                                                                          ^
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:82:27
   |
80 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
   |                           ^^^^^^^^^^^^
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:83:16
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:83:39
   |
81 |         ctx = {}
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                                       ^^^^^^^^^^^^
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
   |

E722 Do not use bare `except`
  --> scripts/handlers_search.py:84:13
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |             ^^^^^^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:84:19
   |
82 |         if os.path.exists(CONTEXT_FILE):
83 |             try: ctx = json.load(open(CONTEXT_FILE))
84 |             except: ctx = {}
   |                   ^
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

F405 `CONTEXT_FILE` may be undefined, or defined from star imports
  --> scripts/handlers_search.py:86:19
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                   ^^^^^^^^^^^^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:86:42
   |
84 |             except: ctx = {}
85 |         ctx[f"{m.chat.id}_search"] = {"cat": cat, "results": results[:5]}
86 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:89:52
   |
87 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
88 |         limit = min(len(results), 5)
89 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
   |                                                    ^
90 |         markup = InlineKeyboardMarkup()
91 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i-1}") for i in range(1, limit+1)]
   |

E722 Do not use bare `except`
  --> scripts/handlers_search.py:94:5
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |     ^^^^^^
   |

E701 Multiple statements on one line (colon)
  --> scripts/handlers_search.py:94:11
   |
92 |         markup.add(*btns)
93 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
94 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
   |           ^
   |

F403 `from config import *` used; unable to detect undefined names
 --> scripts/main.py:5:1
  |
3 | import logging
4 | from flask import Flask
5 | from config import *
  | ^^^^^^^^^^^^^^^^^^^^
6 | from handlers_admin import register_admin_handlers
7 | from handlers_media import register_media_handlers
  |

F405 `TOKEN` may be undefined, or defined from star imports
  --> scripts/main.py:11:23
   |
10 | # --- CONFIGURATION PRINCIPALE ---
11 | bot = telebot.TeleBot(TOKEN)
   |                       ^^^^^
12 |
13 | # --- FLASK SERVER ---
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> scripts/main.py:32:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> scripts/main.py:33:34
   |
31 |     # 2. Register Modules
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
   |                                  ^^^^^^^^^^^^^
34 |     register_search_handlers(bot, is_authorized)
   |

F405 `is_authorized` may be undefined, or defined from star imports
  --> scripts/main.py:34:35
   |
32 |     register_admin_handlers(bot, is_authorized)
33 |     register_media_handlers(bot, is_authorized)
34 |     register_search_handlers(bot, is_authorized)
   |                                   ^^^^^^^^^^^^^
35 |     
36 |     print("üöÄ Bot d√©marr√© en mode modulaire (Orchestrateur Clean)...")
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:27:20
   |
25 |     tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b', r'\b‚Ä¶
26 |     clean = f"{title} ({year})" if year else title
27 |     for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
   |                    ^
28 |     return re.sub(r'\s+', ' ', clean).strip()
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:32:29
   |
30 | def get_size(p):
31 |     try:
32 |         if os.path.isfile(p): return os.path.getsize(p)
   |                             ^
33 |         return sum(os.path.getsize(os.path.join(r, f)) for r, d, fs in os.walk(p) for f in fs)
34 |     except Exception:
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:43:37
   |
41 |     for cat in PATHS:
42 |         for d, is_nvme in [(p, True) for p in PATHS[cat]["nvme"]] + [(PATHS[cat]["hdd"], False)]:
43 |             if not os.path.exists(d): continue
   |                                     ^
44 |             for item in os.listdir(d):
45 |                 if q in item.lower().replace(" ", "").replace(".", ""):
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:60:16
   |
58 |     media = []
59 |     conf = PATHS.get(category)
60 |     if not conf: return []
   |                ^
61 |     for d, is_nvme in [(p, True) for p in conf["nvme"]] + [(conf["hdd"], False)]:
62 |         if not os.path.exists(d): continue
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:62:33
   |
60 |     if not conf: return []
61 |     for d, is_nvme in [(p, True) for p in conf["nvme"]] + [(conf["hdd"], False)]:
62 |         if not os.path.exists(d): continue
   |                                 ^
63 |         for f in os.listdir(d):
64 |             if f.startswith('.'): continue
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:64:33
   |
62 |         if not os.path.exists(d): continue
63 |         for f in os.listdir(d):
64 |             if f.startswith('.'): continue
   |                                 ^
65 |             path = os.path.join(d, f); size = get_size(path)
66 |             if size < MIN_SIZE_BYTES: continue
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/media_manager.py:65:38
   |
63 | ‚Ä¶     for f in os.listdir(d):
64 | ‚Ä¶         if f.startswith('.'): continue
65 | ‚Ä¶         path = os.path.join(d, f); size = get_size(path)
   |                                    ^
66 | ‚Ä¶         if size < MIN_SIZE_BYTES: continue
67 | ‚Ä¶         media.append({"name": clean_media_name(f), "real_name": f, "size_gb": round(size / (1024**3), 2), "is_nvme": is_nvme, "path"‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:66:37
   |
64 |             if f.startswith('.'): continue
65 |             path = os.path.join(d, f); size = get_size(path)
66 |             if size < MIN_SIZE_BYTES: continue
   |                                     ^
67 |             media.append({"name": clean_media_name(f), "real_name": f, "size_gb": round(size / (1024**3), 2), "is_nvme": is_nvme, "pat‚Ä¶
68 |     return sorted(media, key=lambda x: x['size_gb'], reverse=True)
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:71:25
   |
70 | if __name__ == "__main__":
71 |     if len(sys.argv) < 2: sys.exit(1)
   |                         ^
72 |     cmd = sys.argv[1]
73 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:73:26
   |
71 |     if len(sys.argv) < 2: sys.exit(1)
72 |     cmd = sys.argv[1]
73 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
   |                          ^
74 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
75 |     elif cmd == "status":
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:74:31
   |
72 |     cmd = sys.argv[1]
73 |     if cmd == "json_list": print(json.dumps(get_media_list(sys.argv[2])))
74 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
   |                               ^
75 |     elif cmd == "status":
76 |         u = shutil.disk_usage("/"); h = shutil.disk_usage(HDD_ROOT) if os.path.exists(HDD_ROOT) else u
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/media_manager.py:76:35
   |
74 |     elif cmd == "search_local": print(json.dumps(find_local_media(sys.argv[2])))
75 |     elif cmd == "status":
76 |         u = shutil.disk_usage("/"); h = shutil.disk_usage(HDD_ROOT) if os.path.exists(HDD_ROOT) else u
   |                                   ^
77 |         print(json.dumps({"nvme_free": u.free//1024**3, "hdd_free": h.free//1024**3}))
78 |     elif cmd == "action":
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:81:35
   |
79 |         act, cat, path = sys.argv[2], sys.argv[3], sys.argv[4]
80 |         if act == "del":
81 |             if os.path.isdir(path): shutil.rmtree(path)
   |                                   ^
82 |             else: os.remove(path)
83 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:82:17
   |
80 |         if act == "del":
81 |             if os.path.isdir(path): shutil.rmtree(path)
82 |             else: os.remove(path)
   |                 ^
83 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
84 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:83:26
   |
81 |             if os.path.isdir(path): shutil.rmtree(path)
82 |             else: os.remove(path)
83 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
   |                          ^
84 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
85 |         print("Done")
   |

E701 Multiple statements on one line (colon)
  --> scripts/media_manager.py:84:26
   |
82 |             else: os.remove(path)
83 |         elif act == "arc": shutil.move(path, os.path.join(PATHS[cat]["hdd"], os.path.basename(path)))
84 |         elif act == "res": shutil.move(path, os.path.join(PATHS[cat]["nvme"][0], os.path.basename(path)))
   |                          ^
85 |         print("Done")
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:33:8
   |
31 | # --- UTILS & STORAGE ---
32 | def load_allowed_users():
33 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
34 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> scripts/pi_bot.py:34:5
   |
32 | def load_allowed_users():
33 |     try: return json.load(open(USERS_FILE))["allowed"]
34 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
35 |
36 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:34:11
   |
32 | def load_allowed_users():
33 |     try: return json.load(open(USERS_FILE))["allowed"]
34 |     except: return [SUPER_ADMIN]
   |           ^
35 |
36 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:43:94
   |
42 | def get_storage_emoji(item):
43 |     if not item.get('hasFile') and item.get('statistics', {}).get('episodeFileCount', 0) == 0: return "üî¥"
   |                                                                                              ^
44 |     path = item.get('path', '')
45 |     return "üìö" if path and "/mnt/externe" in path else "üöÄ"
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:50:37
   |
48 | @bot.message_handler(commands=['admin'])
49 | def admin_main(m):
50 |     if m.from_user.id != SUPER_ADMIN: return
   |                                     ^
51 |     markup = InlineKeyboardMarkup(row_width=1)
52 |     markup.add(InlineKeyboardButton("üìÇ Partage", callback_data="adm:share"),
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/pi_bot.py:63:30
   |
61 |         users = load_allowed_users()
62 |         if uid not in users:
63 |             users.append(uid); save_users(users)
   |                              ^
64 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
65 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:65:13
   |
63 |             users.append(uid); save_users(users)
64 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
65 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
   |             ^
66 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |

E722 Do not use bare `except`
  --> scripts/pi_bot.py:66:5
   |
64 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
65 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
66 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |     ^^^^^^
67 |
68 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:66:11
   |
64 |             bot.reply_to(m, f"‚úÖ ID {uid} ajout√©.")
65 |         else: bot.reply_to(m, "‚ÑπÔ∏è D√©j√† autoris√©.")
66 |     except: bot.reply_to(m, "‚ùå ID invalide.")
   |           ^
67 |
68 | # --- MEDIA ENGINE (ORIGINAL) ---
   |

E702 Multiple statements on one line (semicolon)
  --> scripts/pi_bot.py:72:39
   |
70 |     res = subprocess.run(["python3", SCRIPT_PATH, "json_list", cat], capture_output=True, text=True)
71 |     try:
72 |         items = json.loads(res.stdout); ctx = {}
   |                                       ^
73 |         if os.path.exists(CONTEXT_FILE):
74 |             try: ctx = json.load(open(CONTEXT_FILE))
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:74:16
   |
72 |         items = json.loads(res.stdout); ctx = {}
73 |         if os.path.exists(CONTEXT_FILE):
74 |             try: ctx = json.load(open(CONTEXT_FILE))
   |                ^
75 |             except: ctx = {}
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
   |

E722 Do not use bare `except`
  --> scripts/pi_bot.py:75:13
   |
73 |         if os.path.exists(CONTEXT_FILE):
74 |             try: ctx = json.load(open(CONTEXT_FILE))
75 |             except: ctx = {}
   |             ^^^^^^
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
77 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:75:19
   |
73 |         if os.path.exists(CONTEXT_FILE):
74 |             try: ctx = json.load(open(CONTEXT_FILE))
75 |             except: ctx = {}
   |                   ^
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
77 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:77:42
   |
75 |             except: ctx = {}
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
77 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
   |                                          ^
78 |     except: return
79 |     if not items:
   |

E722 Do not use bare `except`
  --> scripts/pi_bot.py:78:5
   |
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
77 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
78 |     except: return
   |     ^^^^^^
79 |     if not items:
80 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:78:11
   |
76 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
77 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
78 |     except: return
   |           ^
79 |     if not items:
80 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:81:19
   |
79 |     if not items:
80 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
81 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
   |                   ^
82 |         else: bot.send_message(m.chat.id, msg)
83 |         return
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:82:13
   |
80 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
81 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
82 |         else: bot.send_message(m.chat.id, msg)
   |             ^
83 |         return
84 |     text = f"üé¨ {title} : {cat}\n\n"
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:85:36
   |
83 |         return
84 |     text = f"üé¨ {title} : {cat}\n\n"
85 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
   |                                    ^
86 |     markup = InlineKeyboardMarkup(row_width=5)
87 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:89:15
   |
87 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
88 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
89 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
   |               ^
90 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot.py:90:9
   |
88 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
89 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
90 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
   |         ^
91 |
92 | # --- PAGED MEDIA UI (LIVE API) ---
   |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:98:29
    |
 96 |     try:
 97 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
 98 |         r.raise_for_status(); data = r.json()
    |                             ^
 99 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
100 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:99:31
    |
 97 |         r = requests.get(f"{cfg['url']}/api/v3/{endpoint}", headers={"X-Api-Key": cfg['key']}, timeout=5)
 98 |         r.raise_for_status(); data = r.json()
 99 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
    |                               ^
100 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
101 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:100:13
    |
 98 |         r.raise_for_status(); data = r.json()
 99 |         if category == "films": owned = [f for f in data if f.get('hasFile') is True]
100 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
    |             ^
101 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
102 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:102:27
    |
100 |         else: owned = [s for s in data if s.get('statistics', {}).get('episodeFileCount', 0) > 0]
101 |         owned.sort(key=lambda x: x.get('added', ''), reverse=True)
102 |         total = len(owned); start, end = page * 10, (page + 1) * 10
    |                           ^
103 |         items = owned[start:end]
104 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:104:21
    |
102 |         total = len(owned); start, end = page * 10, (page + 1) * 10
103 |         items = owned[start:end]
104 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                     ^
105 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
106 |         for i, item in enumerate(items, 1):
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:104:59
    |
102 |         total = len(owned); start, end = page * 10, (page + 1) * 10
103 |         items = owned[start:end]
104 |         if not items: bot.send_message(chat_id, "üìÇ Vide."); return
    |                                                            ^
105 |         text = f"{'üé¨' if category == 'films' else 'üì∫'} **{category.capitalize()}** ({total})\n\n"
106 |         for i, item in enumerate(items, 1):
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:112:20
    |
110 |         markup.add(*btns)
111 |         nav = []
112 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
    |                    ^
113 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
114 |         if nav: markup.row(*nav)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:113:23
    |
111 |         nav = []
112 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
113 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
    |                       ^
114 |         if nav: markup.row(*nav)
115 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:114:15
    |
112 |         if page > 0: nav.append(InlineKeyboardButton("‚¨ÖÔ∏è", callback_data=f"m_pag:{category}:{page-1}"))
113 |         if end < total: nav.append(InlineKeyboardButton("‚û°Ô∏è", callback_data=f"m_pag:{category}:{page+1}"))
114 |         if nav: markup.row(*nav)
    |               ^
115 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
116 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:116:18
    |
114 |         if nav: markup.row(*nav)
115 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
116 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
    |                  ^
117 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
118 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:117:13
    |
115 |         markup.add(InlineKeyboardButton("üè† Menu Principal", callback_data="adm:main"))
116 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
117 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
    |             ^
118 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:118:5
    |
116 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
117 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
118 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |     ^^^^^^
119 |
120 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:118:11
    |
116 |         if is_new: bot.send_message(chat_id, text, reply_markup=markup, parse_mode='Markdown')
117 |         else: bot.edit_message_text(text, chat_id, message_id, reply_markup=markup, parse_mode='Markdown')
118 |     except: bot.send_message(chat_id, "‚ùå Erreur API.")
    |           ^
119 |
120 | @bot.message_handler(commands=['films'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:122:32
    |
120 | @bot.message_handler(commands=['films'])
121 | def films_cmd(m):
122 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "films", 0, True)
    |                                ^
123 |
124 | @bot.message_handler(commands=['series'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:126:32
    |
124 | @bot.message_handler(commands=['series'])
125 | def series_cmd(m):
126 |     if is_authorized(m.chat.id): show_media_list(m.chat.id, None, "series", 0, True)
    |                                ^
127 |
128 | # --- SEARCH ENGINE (/GET) ---
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:135:5
    |
133 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
134 |         return res.json()['choices'][0]['message']['content']
135 |     except: return None
    |     ^^^^^^
136 |
137 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:135:11
    |
133 |         res = requests.post("https://api.openai.com/v1/chat/completions", headers=headers, json={"model": "gpt-4o-mini", "messages": ‚Ä¶
134 |         return res.json()['choices'][0]['message']['content']
135 |     except: return None
    |           ^
136 |
137 | @bot.message_handler(commands=['get'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:139:36
    |
137 | @bot.message_handler(commands=['get'])
138 | def handle_get(m):
139 |     if not is_authorized(m.chat.id): return
    |                                    ^
140 |     parts = m.text.split(' ', 1)
141 |     if len(parts) > 1: process_get_request(m, parts[1])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:141:22
    |
139 |     if not is_authorized(m.chat.id): return
140 |     parts = m.text.split(' ', 1)
141 |     if len(parts) > 1: process_get_request(m, parts[1])
    |                      ^
142 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:142:9
    |
140 |     parts = m.text.split(' ', 1)
141 |     if len(parts) > 1: process_get_request(m, parts[1])
142 |     else: bot.reply_to(m, "üé¨ Que veux-tu ?")
    |         ^
143 |
144 | def process_get_request(m, query):
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:149:30
    |
147 |     try:
148 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
149 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
    |                              ^
150 |     except: titre = query; cat = "movie"
151 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:150:5
    |
148 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
149 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
150 |     except: titre = query; cat = "movie"
    |     ^^^^^^
151 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
152 |     try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:150:11
    |
148 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
149 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
150 |     except: titre = query; cat = "movie"
    |           ^
151 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
152 |     try:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:150:26
    |
148 |         data = json.loads(re.search(r'\{.*\}', ai_res, re.DOTALL).group(0))
149 |         titre = data['titre']; cat = "movie" if data['type'] == "film" else "series"
150 |     except: titre = query; cat = "movie"
    |                          ^
151 |     cfg = RADARR_CFG if cat == "movie" else SONARR_CFG
152 |     try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:155:23
    |
153 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
154 |         results = r.json()
155 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                       ^
156 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
157 |         limit = min(len(results), 5)
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:155:73
    |
153 |         r = requests.get(f"{cfg['url']}/api/v3/{cat}/lookup?term={titre}", headers={"X-Api-Key": cfg['key']}, timeout=5)
154 |         results = r.json()
155 |         if not results: bot.send_message(m.chat.id, "‚ùå Aucun r√©sultat."); return
    |                                                                          ^
156 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
157 |         limit = min(len(results), 5)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:158:52
    |
156 |         text = f"üîç **R√©sultats pour '{titre}'**\n\n"
157 |         limit = min(len(results), 5)
158 |         for i, res in enumerate(results[:limit], 1): text += f"{i}. {res['title']} ({res.get('year', 'N/A')})\n"
    |                                                    ^
159 |         markup = InlineKeyboardMarkup()
160 |         btns = [InlineKeyboardButton(str(i), callback_data=f"dl_sel:{cat}:{i}") for i in range(1, limit+1)]
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:163:5
    |
161 |         markup.add(*btns)
162 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
163 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |     ^^^^^^
164 |
165 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:163:11
    |
161 |         markup.add(*btns)
162 |         bot.send_message(m.chat.id, text, reply_markup=markup, parse_mode='Markdown')
163 |     except: bot.send_message(m.chat.id, "‚ùå Erreur.")
    |           ^
164 |
165 | # --- MASTER CALLBACK ROUTER ---
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:168:44
    |
166 | @bot.callback_query_handler(func=lambda call: True)
167 | def master_router(call):
168 |     if not is_authorized(call.from_user.id): return
    |                                            ^
169 |     d = call.data.split(":")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:173:27
    |
171 |     # 1. New Paged UI Callbacks
172 |     if d[0] in ["m_pag", "m_sel", "m_act", "dl_sel"]:
173 |         if d[0] == "m_pag": show_media_list(call.message.chat.id, call.message.message_id, d[1], int(d[2]))
    |                           ^
174 |         elif d[0] == "m_sel":
175 |             markup = InlineKeyboardMarkup()
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:180:30
    |
178 | ‚Ä¶                    InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data=f"m_pag:{d[1]}:0"))
179 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
180 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
    |                            ^
181 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
182 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:181:29
    |
179 | ‚Ä¶         bot.edit_message_text(f"üéØ **Action sur ID {d[2]}**", call.message.chat.id, call.message.message_id, reply_markup=markup)
180 | ‚Ä¶     elif d[0] == "dl_sel": bot.answer_callback_query(call.id, "üì• Ajout√©.")
181 | ‚Ä¶     elif d[0] == "m_act": bot.answer_callback_query(call.id, f"Action {d[1]} enregistr√©e.", show_alert=True)
    |                           ^
182 | ‚Ä¶     return
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:200:41
    |
198 | ‚Ä¶         bot.edit_message_text("üë• **Gestion des Utilisateurs**", call.message.chat.id, call.message.message_id, reply_markup=markup)
199 | ‚Ä¶     elif cmd == "users_list":
200 | ‚Ä¶         users = load_allowed_users(); text = "üìã **Utilisateurs :**\n\n" + "\n".join([f"‚Ä¢ `{u}`" for u in users])
    |                                       ^
201 | ‚Ä¶         bot.edit_message_text(text, call.message.chat.id, call.message.message_id, reply_markup=InlineKeyboardMarkup().add(InlineKe‚Ä¶
202 | ‚Ä¶     elif cmd == "users_add":
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:206:41
    |
204 |             bot.register_next_step_handler(msg, process_user_add)
205 |         elif cmd == "users_rev":
206 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
    |                                         ^
207 |             for u in users:
208 |                 if u == SUPER_ADMIN: continue
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:208:36
    |
206 |             users = load_allowed_users(); markup = InlineKeyboardMarkup(row_width=1)
207 |             for u in users:
208 |                 if u == SUPER_ADMIN: continue
    |                                    ^
209 |                 markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
210 |             markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:213:28
    |
211 | ‚Ä¶         bot.edit_message_text("S√©lectionnez l'ID √† r√©voquer :", call.message.chat.id, call.message.message_id, reply_markup=markup)
212 | ‚Ä¶     elif cmd == "users_del":
213 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
    |                          ^
214 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
215 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:214:28
    |
212 | ‚Ä¶     elif cmd == "users_del":
213 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
214 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                          ^
215 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
216 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:214:47
    |
212 | ‚Ä¶     elif cmd == "users_del":
213 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
214 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                             ^
215 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
216 | ‚Ä¶     elif cmd == "share_owned":
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:214:66
    |
212 | ‚Ä¶     elif cmd == "users_del":
213 | ‚Ä¶         uid = int(d[2]); users = load_allowed_users()
214 | ‚Ä¶         if uid in users: users.remove(uid); save_users(users); bot.answer_callback_query(call.id, "‚úÖ R√©voqu√©.")
    |                                                                ^
215 | ‚Ä¶         master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data="adm:users", chat_instan‚Ä¶
216 | ‚Ä¶     elif cmd == "share_owned":
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:220:33
    |
218 | ‚Ä¶         markup.add(InlineKeyboardButton("üé¨ Films", callback_data="adm:list_owned:movies"), InlineKeyboardButton("üì∫ S√©ries", callba ‚Ä¶
219 | ‚Ä¶         bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
220 | ‚Ä¶     elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
    |                               ^
221 | ‚Ä¶     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
222 | ‚Ä¶     return
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:221:28
    |
219 |             bot.edit_message_text("Cat√©gorie :", call.message.chat.id, call.message.message_id, reply_markup=markup)
220 |         elif cmd == "list_owned": list_media_unified(call.message, d[2], "Partage", True)
221 |         elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                            ^
222 |         return
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:227:46
    |
225 |     if d[0] == "sel":
226 |         try:
227 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                              ^
228 |             markup = InlineKeyboardMarkup(row_width=2)
229 |             act = "arc" if item['is_nvme'] else "res"
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:227:66
    |
225 |     if d[0] == "sel":
226 |         try:
227 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
    |                                                                  ^
228 |             markup = InlineKeyboardMarkup(row_width=2)
229 |             act = "arc" if item['is_nvme'] else "res"
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:231:48
    |
229 | ‚Ä¶     act = "arc" if item['is_nvme'] else "res"
230 | ‚Ä¶     markup.add(InlineKeyboardButton("üì¶ Archiv/Rest", callback_data=f"act:{act}:{d[1]}:{d[2]}"), InlineKeyboardButton("üóëÔ∏è Supprimer"‚Ä¶
231 | ‚Ä¶     if call.from_user.id == SUPER_ADMIN: markup.add(InlineKeyboardButton("üîó Partager", callback_data=f"share_exec:{d[2]}"))
    |                                          ^
232 | ‚Ä¶     markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
233 | ‚Ä¶     bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:234:9
    |
232 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
233 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
234 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |         ^^^^^^
235 |     elif d[0] == "act":
236 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:234:15
    |
232 |             markup.add(InlineKeyboardButton("‚ùå Annuler", callback_data="cancel"))
233 |             bot.edit_message_text(f"üõ†Ô∏è {item['name']}", call.message.chat.id, call.message.message_id, reply_markup=markup)
234 |         except: bot.answer_callback_query(call.id, "‚ùå Session expir√©e.")
    |               ^
235 |     elif d[0] == "act":
236 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:237:46
    |
235 |     elif d[0] == "act":
236 |         try:
237 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                              ^
238 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
239 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:237:66
    |
235 |     elif d[0] == "act":
236 |         try:
237 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
    |                                                                  ^
238 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
239 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:240:9
    |
238 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
239 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
240 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
241 |     elif d[0] == "share_exec":
242 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:240:15
    |
238 |             res = subprocess.run(["python3", SCRIPT_PATH, "action", d[1], d[2], item['path']], capture_output=True, text=True)
239 |             bot.edit_message_text(f"‚úÖ {item['name']}: {res.stdout.strip()}", call.message.chat.id, call.message.message_id)
240 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
241 |     elif d[0] == "share_exec":
242 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:243:46
    |
241 |     elif d[0] == "share_exec":
242 |         try:
243 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
244 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
245 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:243:66
    |
241 |     elif d[0] == "share_exec":
242 |         try:
243 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
244 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
245 |             if subtitles:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:244:45
    |
242 |         try:
243 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
244 |             src = pathlib.Path(item['path']); subtitles = list(src.parent.glob(f"{src.stem}*.srt"))
    |                                             ^
245 |             if subtitles:
246 |                 markup = InlineKeyboardMarkup(row_width=1)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:249:17
    |
247 |                 markup.add(InlineKeyboardButton("‚ö° Symlink", callback_data=f"share_final:{d[1]}:link"), InlineKeyboardButton("üé¨ Remu ‚Ä¶
248 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
249 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
    |                 ^
250 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
251 |     elif d[0] == "share_final":
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:250:9
    |
248 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
249 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
250 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |         ^^^^^^
251 |     elif d[0] == "share_final":
252 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:250:15
    |
248 |                 bot.edit_message_text(f"üéØ **Options Partage**\n{len(subtitles)} sous-titres trouv√©s.", call.message.chat.id, call.mes‚Ä¶
249 |             else: master_router(types.CallbackQuery(id=call.id, from_user=call.from_user, message=call.message, data=f"share_final:{d‚Ä¶
250 |         except: bot.answer_callback_query(call.id, "‚ùå Erreur.")
    |               ^
251 |     elif d[0] == "share_final":
252 |         try:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:253:46
    |
251 |     elif d[0] == "share_final":
252 |         try:
253 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                              ^
254 |             remux_opt = True if d[2] == "remux" else False
255 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:253:66
    |
251 |     elif d[0] == "share_final":
252 |         try:
253 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f); item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
    |                                                                  ^
254 |             remux_opt = True if d[2] == "remux" else False
255 |             bot.edit_message_text("‚è≥ Traitement...", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:260:17
    |
258 |                 msg = f"‚úÖ **Partag√©**\n\nüîó Vid√©o : `{data['video']}`"
259 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
260 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
    |                 ^
261 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
262 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:261:9
    |
259 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
260 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
261 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |         ^^^^^^
262 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:261:15
    |
259 |                 bot.send_message(call.message.chat.id, msg, parse_mode='Markdown')
260 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
261 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
    |               ^
262 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:262:26
    |
260 |             else: bot.send_message(call.message.chat.id, "‚ùå √âchec du partage.")
261 |         except: bot.send_message(call.message.chat.id, "‚ùå Erreur interne.")
262 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
263 |
264 | # --- STATUS & QUEUE ---
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:267:36
    |
265 | @bot.message_handler(commands=['status'])
266 | def status_command(m):
267 |     if not is_authorized(m.chat.id): return
    |                                    ^
268 |     try:
269 |         nvme = shutil.disk_usage('/')
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:276:5
    |
274 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
275 |         bot.reply_to(m, msg, parse_mode='Markdown')
276 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |     ^^^^^^
277 |
278 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:276:11
    |
274 |             msg += f"\nüìö **HDD** : `{fmt(hdd)}`"
275 |         bot.reply_to(m, msg, parse_mode='Markdown')
276 |     except: bot.reply_to(m, "‚ùå Erreur lecture disque.")
    |           ^
277 |
278 | @bot.message_handler(commands=['queue'])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:280:36
    |
278 | @bot.message_handler(commands=['queue'])
279 | def queue_command(m):
280 |     if not is_authorized(m.chat.id): return
    |                                    ^
281 |     try:
282 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:282:82
    |
280 |     if not is_authorized(m.chat.id): return
281 |     try:
282 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
    |                                                                                  ^
283 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
284 |         q_text = "üì• **Queue :**\n\n"
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:283:24
    |
281 |     try:
282 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
283 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                        ^
284 |         q_text = "üì• **Queue :**\n\n"
285 |         for t in torrents:
    |

E702 Multiple statements on one line (semicolon)
   --> scripts/pi_bot.py:283:58
    |
281 |     try:
282 |         r = requests.get("http://localhost:8090/api/v2/torrents/info", timeout=5); torrents = r.json()
283 |         if not torrents: bot.reply_to(m, "‚Ä¢ Queue vide."); return
    |                                                          ^
284 |         q_text = "üì• **Queue :**\n\n"
285 |         for t in torrents:
    |

E722 Do not use bare `except`
   --> scripts/pi_bot.py:290:5
    |
288 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
289 |         bot.reply_to(m, q_text, parse_mode='Markdown')
290 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |     ^^^^^^
291 |
292 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot.py:290:11
    |
288 |                 q_text += f"‚Ä¢ **{name}**\n  ‚îî üìä {round(t['progress']*100,1)}% | üìÇ {round(t['size']/1024**3,2)}GB\n"
289 |         bot.reply_to(m, q_text, parse_mode='Markdown')
290 |     except: bot.reply_to(m, "‚ùå Erreur qBit.")
    |           ^
291 |
292 | # --- STARTUP ---
    |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot_debug.py:35:8
   |
34 | def load_allowed_users():
35 |     try: return json.load(open(USERS_FILE))["allowed"]
   |        ^
36 |     except: return [SUPER_ADMIN]
   |

E722 Do not use bare `except`
  --> scripts/pi_bot_debug.py:36:5
   |
34 | def load_allowed_users():
35 |     try: return json.load(open(USERS_FILE))["allowed"]
36 |     except: return [SUPER_ADMIN]
   |     ^^^^^^
37 |
38 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot_debug.py:36:11
   |
34 | def load_allowed_users():
35 |     try: return json.load(open(USERS_FILE))["allowed"]
36 |     except: return [SUPER_ADMIN]
   |           ^
37 |
38 | def is_authorized(uid): return uid in load_allowed_users()
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot_debug.py:59:40
   |
57 | @bot.callback_query_handler(func=lambda call: call.data.startswith("adm:"))
58 | def admin_router(call):
59 |     if call.from_user.id != SUPER_ADMIN: return
   |                                        ^
60 |     parts = call.data.split(":")
61 |     cmd = parts[1]
   |

E701 Multiple statements on one line (colon)
  --> scripts/pi_bot_debug.py:95:32
   |
93 |         markup = InlineKeyboardMarkup(row_width=1)
94 |         for u in users:
95 |             if u == SUPER_ADMIN: continue
   |                                ^
96 |             markup.add(InlineKeyboardButton(f"‚ùå {u}", callback_data=f"adm:users_del:{u}"))
97 |         markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:users"))
   |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:123:24
    |
121 |         bot.edit_message_text("üßπ **Nettoyage SSD**\n\nFonctionnalit√© en cours de d√©veloppement.", call.message.chat.id, call.message.‚Ä¶
122 |     
123 |     elif cmd == "close": bot.delete_message(call.message.chat.id, call.message.message_id)
    |                        ^
124 |
125 | def process_user_add(m):
    |

E722 Do not use bare `except`
   --> scripts/pi_bot_debug.py:135:5
    |
133 |         else:
134 |             bot.reply_to(m, "‚ÑπÔ∏è Cet utilisateur est d√©j√† autoris√©.")
135 |     except:
    |     ^^^^^^
136 |         bot.reply_to(m, "‚ùå ID invalide. Veuillez envoyer un nombre.")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:145:16
    |
143 |         ctx = {}
144 |         if os.path.exists(CONTEXT_FILE):
145 |             try: ctx = json.load(open(CONTEXT_FILE))
    |                ^
146 |             except: ctx = {}
147 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
    |

E722 Do not use bare `except`
   --> scripts/pi_bot_debug.py:146:13
    |
144 |         if os.path.exists(CONTEXT_FILE):
145 |             try: ctx = json.load(open(CONTEXT_FILE))
146 |             except: ctx = {}
    |             ^^^^^^
147 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
148 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:146:19
    |
144 |         if os.path.exists(CONTEXT_FILE):
145 |             try: ctx = json.load(open(CONTEXT_FILE))
146 |             except: ctx = {}
    |                   ^
147 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
148 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:148:42
    |
146 |             except: ctx = {}
147 |         ctx[str(m.chat.id)] = {"category": cat, "list": items}
148 |         with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                          ^
149 |     except Exception as e:
150 |         logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:154:19
    |
152 |     if not items:
153 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
154 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
    |                   ^
155 |         else: bot.send_message(m.chat.id, msg)
156 |         return
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:155:13
    |
153 |         msg = f"üìÇ Aucun(e) {cat} trouv√©(e)."
154 |         if is_edit: bot.edit_message_text(msg, m.chat.id, m.message_id)
155 |         else: bot.send_message(m.chat.id, msg)
    |             ^
156 |         return
157 |     text = f"üé¨ {title} : {cat}\n\n"
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:158:36
    |
156 |         return
157 |     text = f"üé¨ {title} : {cat}\n\n"
158 |     for i, f in enumerate(items, 1): text += f"{i}. {f['name']} ({f['size_gb']}G)\n"
    |                                    ^
159 |     markup = InlineKeyboardMarkup(row_width=5)
160 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:162:15
    |
160 |     markup.add(*[InlineKeyboardButton(str(i), callback_data=f"sel:{cat}:{i-1}") for i in range(1, len(items)+1)])
161 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
162 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
    |               ^
163 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:163:9
    |
161 |     markup.add(InlineKeyboardButton("‚¨ÖÔ∏è Retour", callback_data="adm:share_owned"))
162 |     if is_edit: bot.edit_message_text(text, m.chat.id, m.message_id, reply_markup=markup)
163 |     else: bot.send_message(m.chat.id, text, reply_markup=markup)
    |         ^
164 |
165 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:167:44
    |
165 | @bot.callback_query_handler(func=lambda call: call.data.startswith(("sel:", "act:", "share_exec:", "cancel", "dl:")))
166 | def media_callbacks(call):
167 |     if not is_authorized(call.from_user.id): return
    |                                            ^
168 |     d = call.data.split(":")
169 |     if d[0] == "sel":
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:171:46
    |
169 |     if d[0] == "sel":
170 |         try:
171 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
172 |             item = ctx[str(call.message.chat.id)]["list"][int(d[2])]
173 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:187:46
    |
185 |     elif d[0] == "act":
186 |         try:
187 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
188 |             item = ctx[str(call.message.chat.id)]["list"][int(d[3])]
189 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:197:46
    |
195 |     elif d[0] == "share_exec":
196 |         try:
197 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
198 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
199 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:220:46
    |
218 |     elif d[0] == "share_final":
219 |         try:
220 |             with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                              ^
221 |             item = ctx[str(call.message.chat.id)]["list"][int(d[1])]
222 |         except Exception as e:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:244:26
    |
242 |         else:
243 |             bot.send_message(call.message.chat.id, "‚ùå Erreur: √âchec du partage ou contenu hors limites.")
244 |     elif d[0] == "cancel": bot.edit_message_text("‚ùå Ferm√©.", call.message.chat.id, call.message.message_id)
    |                          ^
245 |     elif d[0] == "dl":
246 |         if d[1] == "no":
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:251:50
    |
249 |         elif d[1] == "yes":
250 |             try:
251 |                 with open(CONTEXT_FILE, "r") as f: ctx = json.load(f)
    |                                                  ^
252 |                 dl_data = ctx.get(str(call.message.chat.id) + "_dl")
253 |                 if not dl_data:
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:293:36
    |
291 | @bot.message_handler(commands=['status'])
292 | def status_command(m):
293 |     if not is_authorized(m.chat.id): return
    |                                    ^
294 |     try:
295 |         nvme = shutil.disk_usage('/')
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:306:36
    |
304 | @bot.message_handler(commands=['films'])
305 | def films_command(m):
306 |     if not is_authorized(m.chat.id): return
    |                                    ^
307 |     try:
308 |         logging.info(f"[DEBUG_API] Interrogation Radarr √† {RADARR_CFG['url']}")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:323:36
    |
321 | @bot.message_handler(commands=['series'])
322 | def series_command(m):
323 |     if not is_authorized(m.chat.id): return
    |                                    ^
324 |     try:
325 |         r = requests.get(f"{SONARR_CFG['url']}/api/v3/series", headers={"X-Api-Key": SONARR_CFG['key']}, timeout=5)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:337:36
    |
335 | @bot.message_handler(commands=['queue'])
336 | def queue_command(m):
337 |     if not is_authorized(m.chat.id): return
    |                                    ^
338 |     
339 |     def clean_title(name):
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:347:24
    |
345 | ‚Ä¶     tags = [r'\b\d{3,4}p\b', r'\b2160p\b', r'\b4k\b', r'\bHEVC\b', r'\bx26[45]\b', r'\bBluRay\b', r'\bWEB-DL\b', r'\bCOMPLETE\b', r‚Ä¶
346 | ‚Ä¶     clean = f"{title} ({year})" if year else title
347 | ‚Ä¶     for tag in tags: clean = re.sub(tag, '', clean, flags=re.IGNORECASE)
    |                      ^
348 | ‚Ä¶     return re.sub(r'\s+', ' ', clean).strip()
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:361:42
    |
359 |                     progress = round(t['progress'] * 100, 1)
360 |                     eta_sec = t['eta']
361 |                     if eta_sec >= 8640000: eta = "‚àû"
    |                                          ^
362 |                     else:
363 |                         eta = str(timedelta(seconds=eta_sec)).split(".")[0]
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:435:36
    |
433 | @bot.message_handler(commands=['get'])
434 | def handle_get_command_entry(m):
435 |     if not is_authorized(m.chat.id): return
    |                                    ^
436 |     parts = m.text.split(' ', 1)
437 |     if len(parts) > 1 and parts[1].strip():
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:445:36
    |
444 | def process_get_step(m):
445 |     if not is_authorized(m.chat.id): return
    |                                    ^
446 |     if m.text.startswith('/'):
447 |         return
    |

F841 Local variable `saison` is assigned to but never used
   --> scripts/pi_bot_debug.py:468:9
    |
466 |         titre = str(data.get('titre'))
467 |         type_media = str(data.get('type'))
468 |         saison = int(data['saison']) if data.get('saison') is not None else None
    |         ^^^^^^
469 |         episode = int(data['episode']) if data.get('episode') is not None else None
470 |     except (ValueError, TypeError):
    |
help: Remove assignment to unused variable `saison`

F841 Local variable `episode` is assigned to but never used
   --> scripts/pi_bot_debug.py:469:9
    |
467 |         type_media = str(data.get('type'))
468 |         saison = int(data['saison']) if data.get('saison') is not None else None
469 |         episode = int(data['episode']) if data.get('episode') is not None else None
    |         ^^^^^^^
470 |     except (ValueError, TypeError):
471 |         bot.reply_to(m, "‚ùå Erreur de formatage des m√©tadonn√©es extraites.")
    |
help: Remove assignment to unused variable `episode`

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:516:20
    |
514 |             ctx = {}
515 |             if os.path.exists(CONTEXT_FILE):
516 |                 try: ctx = json.load(open(CONTEXT_FILE))
    |                    ^
517 |                 except: ctx = {}
518 |             ctx[str(m.chat.id) + "_dl"] = {
    |

E722 Do not use bare `except`
   --> scripts/pi_bot_debug.py:517:17
    |
515 |             if os.path.exists(CONTEXT_FILE):
516 |                 try: ctx = json.load(open(CONTEXT_FILE))
517 |                 except: ctx = {}
    |                 ^^^^^^
518 |             ctx[str(m.chat.id) + "_dl"] = {
519 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:517:23
    |
515 |             if os.path.exists(CONTEXT_FILE):
516 |                 try: ctx = json.load(open(CONTEXT_FILE))
517 |                 except: ctx = {}
    |                       ^
518 |             ctx[str(m.chat.id) + "_dl"] = {
519 |                 "type_media": type_media,
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:526:46
    |
524 |                 "images": item.get('images')
525 |             }
526 |             with open(CONTEXT_FILE, "w") as f: json.dump(ctx, f)
    |                                              ^
527 |         except Exception as e:
528 |             logging.error(f"Context save failed: {e}")
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:555:36
    |
553 | @bot.message_handler(func=lambda m: True)
554 | def handle_ai_request(m):
555 |     if not is_authorized(m.chat.id): return
    |                                    ^
556 |     if m.text.startswith('/'): return # Ignore native commands
557 |     process_get_request(m, m.text)
    |

E701 Multiple statements on one line (colon)
   --> scripts/pi_bot_debug.py:556:30
    |
554 | def handle_ai_request(m):
555 |     if not is_authorized(m.chat.id): return
556 |     if m.text.startswith('/'): return # Ignore native commands
    |                              ^
557 |     process_get_request(m, m.text)
    |

E701 Multiple statements on one line (colon)
  --> scripts/share_engine.py:20:41
   |
18 | def load_config():
19 |     try:
20 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
   |                                         ^
21 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |

E722 Do not use bare `except`
  --> scripts/share_engine.py:21:5
   |
19 |     try:
20 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
21 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |     ^^^^^^
22 |
23 | def get_video_info(path):
   |

E701 Multiple statements on one line (colon)
  --> scripts/share_engine.py:21:11
   |
19 |     try:
20 |         with open(CONFIG_FILE, 'r') as f: return json.load(f)
21 |     except: return {"max_gb": 4.0, "max_res": 1080}
   |           ^
22 |
23 | def get_video_info(path):
   |

E722 Do not use bare `except`
  --> scripts/share_engine.py:46:9
   |
44 |             res = subprocess.run(cmd, capture_output=True, text=True, timeout=5)
45 |             height = int(res.stdout.strip()) if res.stdout.strip().isdigit() else 1080
46 |         except:
   |         ^^^^^^
47 |             logging.warning("ffprobe not found or failed, defaulting to 1080p.")
48 |             height = 1080
   |

E722 Do not use bare `except`
  --> scripts/share_engine.py:65:5
   |
63 |         res = subprocess.run(cmd, capture_output=True, text=True)
64 |         return res.returncode == 0
65 |     except: return False
   |     ^^^^^^
66 |
67 | def generate_secure_link(source_path, remux=False):
   |

E701 Multiple statements on one line (colon)
  --> scripts/share_engine.py:65:11
   |
63 |         res = subprocess.run(cmd, capture_output=True, text=True)
64 |         return res.returncode == 0
65 |     except: return False
   |           ^
66 |
67 | def generate_secure_link(source_path, remux=False):
   |

E701 Multiple statements on one line (colon)
   --> scripts/share_engine.py:131:36
    |
130 |     try:
131 |         if video_dest_path.exists(): video_dest_path.unlink()
    |                                    ^
132 |         os.symlink(src, video_dest_path)
133 |         logging.info(f"Symlink created: {video_dest_path}")
    |

E701 Multiple statements on one line (colon)
   --> scripts/share_engine.py:143:38
    |
141 |         sub_dest_path = Path(SHARE_DIR) / sub_share_name
142 |         try:
143 |             if sub_dest_path.exists(): sub_dest_path.unlink()
    |                                      ^
144 |             os.symlink(sub, sub_dest_path)
145 |             result["subtitles"].append(f"{current_base_url}/{sub_share_name}")
    |

E722 Do not use bare `except`
   --> scripts/share_engine.py:146:9
    |
144 |             os.symlink(sub, sub_dest_path)
145 |             result["subtitles"].append(f"{current_base_url}/{sub_share_name}")
146 |         except: pass
    |         ^^^^^^
147 |     return result
    |

E701 Multiple statements on one line (colon)
   --> scripts/share_engine.py:146:15
    |
144 |             os.symlink(sub, sub_dest_path)
145 |             result["subtitles"].append(f"{current_base_url}/{sub_share_name}")
146 |         except: pass
    |               ^
147 |     return result
    |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:10:29
   |
 8 |     s = 0
 9 |     try:
10 |         if os.path.isfile(p): s = os.path.getsize(p)
   |                             ^
11 |         else:
12 |             for r, d, f in os.walk(p):
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:13:30
   |
11 |         else:
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
   |                              ^
14 |     except: return 0
15 |     return round(s / (1024**3), 2)
   |

E722 Do not use bare `except`
  --> scripts/storage_manager.py:14:5
   |
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
14 |     except: return 0
   |     ^^^^^^
15 |     return round(s / (1024**3), 2)
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:14:11
   |
12 |             for r, d, f in os.walk(p):
13 |                 for file in f: s += os.path.getsize(os.path.join(r, file))
14 |     except: return 0
   |           ^
15 |     return round(s / (1024**3), 2)
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:18:32
   |
17 | def list_items(path):
18 |     if not os.path.exists(path): return f"‚ùå {path} absent."
   |                                ^
19 |     items = [f for f in os.listdir(path) if not f.startswith('.')]
20 |     out = f"üìÇ **{os.path.basename(path)}** :\n"
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:29:21
   |
27 | if __name__ == "__main__":
28 |     arg = sys.argv[1] if len(sys.argv) > 1 else ""
29 |     if arg == "nvme": print(list_items(NVME_DIR))
   |                     ^
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
31 |     else: print("Commande re√ßue : " + arg)
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:30:22
   |
28 |     arg = sys.argv[1] if len(sys.argv) > 1 else ""
29 |     if arg == "nvme": print(list_items(NVME_DIR))
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
   |                      ^
31 |     else: print("Commande re√ßue : " + arg)
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_manager.py:31:9
   |
29 |     if arg == "nvme": print(list_items(NVME_DIR))
30 |     elif arg == "hdd": print(list_items(HDD_DIR))
31 |     else: print("Commande re√ßue : " + arg)
   |         ^
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_skill.py:11:32
   |
 9 | def list_media(category="movies"):
10 |     path = PATHS.get(category)
11 |     if not os.path.exists(path): return f"‚ùå Dossier {category} introuvable."
   |                                ^
12 |     items = [f for f in os.listdir(path) if not f.startswith('.')]
13 |     return f"üé• **{category.capitalize()} :**\n" + "\n".join([f"‚Ä¢ {i}" for i in sorted(items)]) if items else f"üìÇ Aucun contenu dans { ‚Ä¶
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_skill.py:25:53
   |
23 |     if len(sys.argv) > 1:
24 |         cmd = sys.argv[1]
25 |         if cmd == "list_media" and len(sys.argv) > 2: print(list_media(sys.argv[2]))
   |                                                     ^
26 |         elif cmd == "get_status": print(get_status())
   |

E701 Multiple statements on one line (colon)
  --> scripts/storage_skill.py:26:33
   |
24 |         cmd = sys.argv[1]
25 |         if cmd == "list_media" and len(sys.argv) > 2: print(list_media(sys.argv[2]))
26 |         elif cmd == "get_status": print(get_status())
   |                                 ^
   |

E701 Multiple statements on one line (colon)
  --> scripts/tests/test_cleanup.py:41:34
   |
40 |     def side_effect_lstat(path):
41 |         if 'old_file.mkv' in path: return mock_stat_old
   |                                  ^
42 |         return mock_stat_new
   |

E712 Avoid equality comparisons to `True`; use `config.is_authorized(config.SUPER_ADMIN):` for truth checks
  --> scripts/tests/test_config.py:31:12
   |
29 | def test_is_authorized_super_admin():
30 |     import config
31 |     assert config.is_authorized(config.SUPER_ADMIN) == True
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `config.is_authorized(config.SUPER_ADMIN)`

Found 1038 errors (146 fixed, 892 remaining).
No fixes available (10 hidden fixes can be enabled with the `--unsafe-fixes` option).
Exit Code: 1
Process Group PGID: 320923